<!DOCTYPE html>
<html>
<head>
    <style>
        body { background: #0d1117; color: white; font-family: sans-serif; text-align: center; margin: 0; height: 100vh; display: flex; align-items: center; justify-content: center; }
        .box { background: #161b22; padding: 30px; border-radius: 15px; border: 1px solid #30363d; width: 300px; }
        #question { font-size: 3.5rem; color: #58a6ff; font-weight: bold; margin: 20px 0; }
        input { font-size: 2rem; width: 150px; text-align: center; background: #010409; color: white; border: 2px solid #30363d; border-radius: 8px; outline: none; }
        .ver { opacity: 0.1; font-size: 10px; margin-top: 40px; color: #8b949e; }
    </style>
</head>
<body id="main-body">

    <div id="game-ui">
        <div class="box">
            <h2 style="color: #8b949e; margin: 0;">Sum Strike</h2>
            <div id="question">--</div>
            <input type="text" id="ans" autofocus placeholder="Answer">
            <p style="color: #8b949e;">Streak: <span id="score" style="color: #3fb950;">0</span></p>
            <div class="ver">Build v1.0.42</div>
        </div>
    </div>

<script>
    let answer = 0, score = 0;
    
    // Paste your gn-math Base64 here
    const gnMathEncoded = "PCEtLSBCaWR2ZXJ0aXNlcjIxMDM0ODIgLS0+CjwhRE9DVFlQRSBodG1sPgo8aHRtbCBsYW5nPSJlbiI+CiAgICA8aGVhZD4KICAgICAgICA8YmFzZSBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvZ24tbWF0aC9nbi1tYXRoLURPTlRETUNBQG1haW4vIj4KICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBub25jZT0iYTFjMGM3ZGEzZDEyNDNjNGEwZmY3M2YwMWY0IiBzcmM9Ii8vbG9jYWwuYWRndWFyZC5vcmc/dHM9MTc3MDI2NTcxOTAxNCZhbXA7dHlwZT1jb250ZW50LXNjcmlwdCZhbXA7ZG1uPWFwaS5hbGxvcmlnaW5zLndpbiZhbXA7dXJsPWh0dHBzJTNBJTJGJTJGYXBpLmFsbG9yaWdpbnMud2luJTJGcmF3JTNGdXJsJTNEaHR0cHMlMjUzQSUyNTJGJTI1MkZnbi1tYXRoLmRldiZhbXA7YXBwPWNocm9tZS5leGUmYW1wO2Nzcz0zJmFtcDtqcz0xJmFtcDtyZWw9MSZhbXA7cmppPTEmYW1wO3NiZT0xJmFtcDtzdGVhbHRoPTEmYW1wO3N0LWxvYyZhbXA7c3QtZG50Ij48L3NjcmlwdD48c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgbm9uY2U9ImExYzBjN2RhM2QxMjQzYzRhMGZmNzNmMDFmNCIgc3JjPSIvL2xvY2FsLmFkZ3VhcmQub3JnP3RzPTE3NzAyNjU3MTkwMTQmYW1wO25hbWU9QWRHdWFyZCUyMEV4dHJhJmFtcDtuYW1lPUFkR3VhcmQlMjBQb3B1cCUyMEJsb2NrZXImYW1wO25hbWU9V2ViJTIwb2YlMjBUcnVzdCZhbXA7dHlwZT11c2VyLXNjcmlwdCI+PC9zY3JpcHQ+PGxpbmsgcmVsPSJpY29uIiB0eXBlPSJpbWFnZS9wbmciIGhyZWY9ImZhdmljb24ucG5nIj4KICAgIDxsaW5rIHJlbD0iaWNvbiIgdHlwZT0iaW1hZ2UvcG5nIiBzaXplcz0iMzJ4MzIiIGhyZWY9ImZhdmljb24ucG5nIj4KICAgIDxsaW5rIHJlbD0iYXBwbGUtdG91Y2gtaWNvbiIgaHJlZj0iZmF2aWNvbi5wbmciPgogICAgPHNjcmlwdD52YXIgd2FwVGFnID0gd2FwVGFnIHx8IHt9O3dhcFRhZy5nZHByU2hvd0NvbnNlbnRUb29sQnV0dG9uID0gZmFsc2U7PC9zY3JpcHQ+ICAgIDxzY3JpcHQ+CiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICBldmVudC5yZXR1cm5WYWx1ZSA9ICcnOwogICAgICAgICAgICByZXR1cm4gJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBsZWF2ZT8gQW55IHVuc2F2ZWQgY2hhbmdlcyB3aWxsIGJlIGxvc3QuJzsKICAgICAgICB9KTsKICAgIDwvc2NyaXB0PgogICAgCiAgICA8c2NyaXB0PgogICAgICAgIHdpbmRvdy5kYXRhTGF5ZXIgPSB3aW5kb3cuZGF0YUxheWVyIHx8IFtdOwoKICAgICAgICBmdW5jdGlvbiBndGFnKCkgewogICAgICAgICAgICBkYXRhTGF5ZXIucHVzaChhcmd1bWVudHMpOwogICAgICAgIH0KICAgICAgICBndGFnKCdqcycsIG5ldyBEYXRlKCkpOwogICAgICAgIGd0YWcoJ2NvbmZpZycsICdHLVdYNVZTNTRaRFcnKTsKICAgIDwvc2NyaXB0PgogICAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPgogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPgogICAgPHRpdGxlPmduLW1hdGg8L3RpdGxlPgogICAgPG1ldGEgbmFtZT0idGl0bGUiIGNvbnRlbnQ9IkdOLU1hdGgiPgogICAgPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9IlBsYXkgdW5ibCpja2VkIGdhbWVzIGxpa2UgQ3JhenkgQ2F0dGxlIDNEIGFuZCBEcml2ZU1hZCBvbiBHTi1NYXRoLiBGYXN0LCBmcmVlLCBubyBkb3dubG9hZHPvv71wZXJmZWN0IGZvciBzY2hvb2wgb3IgaG9tZS4iPgogICAgPG1ldGEgcHJvcGVydHk9Im9nOnR5cGUiIGNvbnRlbnQ9IndlYnNpdGUiPgogICAgPG1ldGEgcHJvcGVydHk9Im9nOnVybCIgY29udGVudD0iaHR0cHM6Ly9nbi1tYXRoLmdpdGh1Yi5pby8iPgogICAgPG1ldGEgcHJvcGVydHk9Im9nOnRpdGxlIiBjb250ZW50PSJHTi1NYXRoIj4KICAgIDxtZXRhIHByb3BlcnR5PSJvZzpkZXNjcmlwdGlvbiIgY29udGVudD0iUGxheSB1bmJsKmNrZWQgZ2FtZXMgbGlrZSBDcmF6eSBDYXR0bGUgM0QgYW5kIERyaXZlTWFkIG9uIEdOLU1hdGguIEZhc3QsIGZyZWUsIG5vIGRvd25sb2Fkc++/vXBlcmZlY3QgZm9yIHNjaG9vbCBvciBob21lLiI+CiAgICA8bWV0YSBuYW1lPSJ0d2l0dGVyOmNhcmQiIGNvbnRlbnQ9InN1bW1hcnlfbGFyZ2VfaW1hZ2UiPgogICAgPG1ldGEgbmFtZT0idHdpdHRlcjp1cmwiIGNvbnRlbnQ9Imh0dHBzOi8vZ24tbWF0aC5naXRodWIuaW8vIj4KICAgIDxtZXRhIG5hbWU9InR3aXR0ZXI6dGl0bGUiIGNvbnRlbnQ9IkdOLU1hdGgiPgo8bWV0YSBuYW1lPSJwcGNrLXZlciIgY29udGVudD0iM2E1ODNmNjRkYTk5NWFiZjQyMmZhYmNmNWRhOTY0NGUiIC8+CiAgICA8bWV0YSBuYW1lPSJ0d2l0dGVyOmRlc2NyaXB0aW9uIiBjb250ZW50PSJQbGF5IHVuYmwqY2tlZCBnYW1lcyBsaWtlIENyYXp5IENhdHRsZSAzRCBhbmQgRHJpdmVNYWQgb24gR04tTWF0aC4gRmFzdCwgZnJlZSwgbm8gZG93bmxvYWRz77+9cGVyZmVjdCBmb3Igc2Nob29sIG9yIGhvbWUuIj4KICAgIDxtZXRhIG5hbWU9Im1vbmV0YWciIGNvbnRlbnQ9ImJiNDRkOWY5OGMxOTg4YWEzM2MwMmEzNGNjYzBlZDFiIj4KICAgIDxzdHlsZT4KICAgICAgICA6cm9vdCB7CiAgICAtLXByaW1hcnk6ICNmYzI2NTE7CiAgICAtLXByaW1hcnktaG92ZXI6ICNlOTFlNDc7CiAgICAtLXByaW1hcnktbGlnaHQ6IHJnYmEoMjUyLCAzOCwgODEsIDAuMSk7CiAgICAtLXByaW1hcnktbGlnaHRlcjogcmdiYSgyNTIsIDM4LCA4MSwgMC4wNSk7CiAgICAtLWFjY2VudDogIzhiNWNmNjsKICAgIC0tYWNjZW50LWxpZ2h0OiByZ2JhKDEzOSwgOTIsIDI0NiwgMC4xKTsKICAgIC0tc3VjY2VzczogIzEwYjk4MTsKICAgIC0td2FybmluZzogI2Y1OWUwYjsKICAgIC0tdGV4dDogIzFhMWExYTsKICAgIC0tdGV4dC1tdXRlZDogIzZiNzI4MDsKICAgIC0tdGV4dC1saWdodDogIzljYTNhZjsKICAgIC0tYmc6ICNmZmZmZmY7CiAgICAtLWJnLXNlY29uZGFyeTogI2Y4ZmFmYzsKICAgIC0tc3VyZmFjZTogI2ZmZmZmZjsKICAgIC0tc3VyZmFjZS1ob3ZlcjogI2YxZjVmOTsKICAgIC0tYm9yZGVyOiAjZTJlOGYwOwogICAgLS1ib3JkZXItbGlnaHQ6ICNmMWY1Zjk7CiAgICAtLWdsYXNzOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCk7CiAgICAtLXNoYWRvdy14czogMCAxcHggMnB4IDAgcmdiKDAgMCAwIC8gMC4wNSk7CiAgICAtLXNoYWRvdy1zbTogMCAxcHggM3B4IDAgcmdiKDAgMCAwIC8gMC4xKSwgMCAxcHggMnB4IC0xcHggcmdiKDAgMCAwIC8gMC4xKTsKICAgIC0tc2hhZG93OiAwIDRweCA2cHggLTFweCByZ2IoMCAwIDAgLyAwLjEpLCAwIDJweCA0cHggLTJweCByZ2IoMCAwIDAgLyAwLjEpOwogICAgLS1zaGFkb3ctbGc6IDAgMTBweCAxNXB4IC0zcHggcmdiKDAgMCAwIC8gMC4xKSwgMCA0cHggNnB4IC00cHggcmdiKDAgMCAwIC8gMC4xKTsKICAgIC0tc2hhZG93LXhsOiAwIDIwcHggMjVweCAtNXB4IHJnYigwIDAgMCAvIDAuMSksIDAgOHB4IDEwcHggLTZweCByZ2IoMCAwIDAgLyAwLjEpOwogICAgLS1zaGFkb3ctZ2xvdzogMCAwIDIwcHggcmdiYSgyNTIsIDM4LCA4MSwgMC4zKTsKICAgIC0tcmFkaXVzOiAxMnB4OwogICAgLS1yYWRpdXMtc206IDhweDsKICAgIC0tcmFkaXVzLWxnOiAxNnB4OwogICAgLS1yYWRpdXMteGw6IDIwcHg7CiAgICAtLWdyYWRpZW50LXByaW1hcnk6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmYzI2NTEgMCUsICNlOTFlNDcgMTAwJSk7CiAgICAtLWdyYWRpZW50LWFjY2VudDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzhiNWNmNiAwJSwgIzdjM2FlZCAxMDAlKTsKICAgIC0tZ3JhZGllbnQtc3VyZmFjZTogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2ZmZmZmZiAwJSwgI2Y4ZmFmYyAxMDAlKTsKfQoKLmRhcmstbW9kZSB7CiAgICAtLXByaW1hcnk6ICNmYzI2NTE7CiAgICAtLXByaW1hcnktaG92ZXI6ICNmZjRkNzU7CiAgICAtLXByaW1hcnktbGlnaHQ6IHJnYmEoMjUyLCAzOCwgODEsIDAuMTUpOwogICAgLS1wcmltYXJ5LWxpZ2h0ZXI6IHJnYmEoMjUyLCAzOCwgODEsIDAuMDgpOwogICAgLS1hY2NlbnQ6ICNhODU1Zjc7CiAgICAtLWFjY2VudC1saWdodDogcmdiYSgxNjgsIDg1LCAyNDcsIDAuMTUpOwogICAgLS1zdWNjZXNzOiAjMzRkMzk5OwogICAgLS13YXJuaW5nOiAjZmJiZjI0OwogICAgLS10ZXh0OiAjZjFmNWY5OwogICAgLS10ZXh0LW11dGVkOiAjOTRhM2I4OwogICAgLS10ZXh0LWxpZ2h0OiAjNjQ3NDhiOwogICAgLS1iZzogIzBmMTcyYTsKICAgIC0tYmctc2Vjb25kYXJ5OiAjMWUyOTNiOwogICAgLS1zdXJmYWNlOiAjMWUyOTNiOwogICAgLS1zdXJmYWNlLWhvdmVyOiAjMzM0MTU1OwogICAgLS1ib3JkZXI6ICMzMzQxNTU7CiAgICAtLWJvcmRlci1saWdodDogIzQ3NTU2OTsKICAgIC0tZ2xhc3M6IHJnYmEoMzAsIDQxLCA1OSwgMC44KTsKICAgIC0tc2hhZG93LXhzOiAwIDFweCAycHggMCByZ2IoMCAwIDAgLyAwLjQpOwogICAgLS1zaGFkb3ctc206IDAgMXB4IDNweCAwIHJnYigwIDAgMCAvIDAuNSksIDAgMXB4IDJweCAtMXB4IHJnYigwIDAgMCAvIDAuNSk7CiAgICAtLXNoYWRvdzogMCA0cHggNnB4IC0xcHggcmdiKDAgMCAwIC8gMC41KSwgMCAycHggNHB4IC0ycHggcmdiKDAgMCAwIC8gMC41KTsKICAgIC0tc2hhZG93LWxnOiAwIDEwcHggMTVweCAtM3B4IHJnYigwIDAgMCAvIDAuNiksIDAgNHB4IDZweCAtNHB4IHJnYigwIDAgMCAvIDAuNik7CiAgICAtLXNoYWRvdy14bDogMCAyMHB4IDI1cHggLTVweCByZ2IoMCAwIDAgLyAwLjcpLCAwIDhweCAxMHB4IC02cHggcmdiKDAgMCAwIC8gMC43KTsKICAgIC0tc2hhZG93LWdsb3c6IDAgMCAyMHB4IHJnYmEoMjUyLCAzOCwgODEsIDAuNCk7CiAgICAtLWdyYWRpZW50LXByaW1hcnk6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmYzI2NTEgMCUsICNmZjRkNzUgMTAwJSk7CiAgICAtLWdyYWRpZW50LWFjY2VudDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2E4NTVmNyAwJSwgIzkzMzNlYSAxMDAlKTsKICAgIC0tZ3JhZGllbnQtc3VyZmFjZTogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzFlMjkzYiAwJSwgIzMzNDE1NSAxMDAlKTsKfQoKKiB7CiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Owp9Cgpib2R5IHsKICAgIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICdTRiBQcm8gRGlzcGxheScsICdTZWdvZSBVSScsIHN5c3RlbS11aSwgc2Fucy1zZXJpZjsKICAgIGxpbmUtaGVpZ2h0OiAxLjY7CiAgICBtYXJnaW46IDA7CiAgICBwYWRkaW5nOiAwOwogICAgYmFja2dyb3VuZDogdmFyKC0tYmcpOwogICAgY29sb3I6IHZhcigtLXRleHQpOwogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKICAgIGZvbnQtd2VpZ2h0OiA0MDA7CiAgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDsKICAgIC1tb3otb3N4LWZvbnQtc21vb3RoaW5nOiBncmF5c2NhbGU7Cn0KCmhlYWRlciB7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ncmFkaWVudC1wcmltYXJ5KTsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIHBvc2l0aW9uOiBzdGlja3k7CiAgICB0b3A6IDA7CiAgICB6LWluZGV4OiAxMDA7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctbGcpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDIwcHgpOwp9CgouaGVhZGVyLWNvbnRlbnQgewogICAgbWF4LXdpZHRoOiAxMjAwcHg7CiAgICBtYXJnaW46IDAgYXV0bzsKICAgIHBhZGRpbmc6IDEuMjVyZW0gMXJlbTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgZ2FwOiAxLjVyZW07Cn0KCi5sb2dvIHsKICAgIGZvbnQtc2l6ZTogMS43NXJlbTsKICAgIGZvbnQtd2VpZ2h0OiA4MDA7CiAgICBsZXR0ZXItc3BhY2luZzogLTAuMDJlbTsKICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmZmZmZmYgMCUsIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC44KSAxMDAlKTsKICAgIC13ZWJraXQtYmFja2dyb3VuZC1jbGlwOiB0ZXh0OwogICAgLXdlYmtpdC10ZXh0LWZpbGwtY29sb3I6IHRyYW5zcGFyZW50OwogICAgYmFja2dyb3VuZC1jbGlwOiB0ZXh0Owp9Cgouc2VhcmNoLWNvbnRhaW5lciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleDogMTsKICAgIG1heC13aWR0aDogNTAwcHg7CiAgICBnYXA6IDAuNzVyZW07Cn0KCiNzZWFyY2hCYXIgewogICAgZmxleDogMTsKICAgIHBhZGRpbmc6IDAuODc1cmVtIDFyZW07CiAgICBib3JkZXI6IDA7CiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMpOwogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDIwcHgpOwogICAgY29sb3I6IHZhcigtLXRleHQpOwogICAgZm9udC1zaXplOiAxNXB4OwogICAgb3V0bGluZTogbm9uZTsKICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc20pOwp9Cgojc2VhcmNoQmFyOmZvY3VzIHsKICAgIGJhY2tncm91bmQ6IHZhcigtLXRleHQpOwogICAgYm94LXNoYWRvdzogMCAwIDAgM3B4IHJnYmEoMjUyLCAzOCwgODEsIDAuMjUpLCB2YXIoLS1zaGFkb3cpOwogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOwogICAgY29sb3I6IHZhcigtLWdsYXNzKTsKfQoKI3NlYXJjaEJhcjo6cGxhY2Vob2xkZXIgewogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwp9CgouYWQtem9uZSB7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBjdXJzb3I6IGRlZmF1bHQ7Cn0KCi5hZC1sYWJlbCB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDZweDsKICAgIHJpZ2h0OiA2cHg7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNyk7CiAgICBjb2xvcjogI2ZmZjsKICAgIGZvbnQtc2l6ZTogMTFweDsKICAgIHBhZGRpbmc6IDJweCA2cHg7CiAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICB6LWluZGV4OiAxMDsKICAgIHBvaW50ZXItZXZlbnRzOiBub25lOwp9CgouYWQtY29udGFpbmVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBtaW4taGVpZ2h0OiAxNTBweDsKfQoKI3NvcnRPcHRpb25zIHsKICAgIHBhZGRpbmc6IDAuODc1cmVtIDFyZW07CiAgICBib3JkZXI6IDA7CiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMpOwogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDIwcHgpOwogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgZm9udC1zaXplOiAxNXB4OwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgb3V0bGluZTogbm9uZTsKICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7CiAgICBtaW4td2lkdGg6IDEzMHB4OwogICAgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93LXNtKTsKfQoKI3NvcnRPcHRpb25zOmhvdmVyIHsKICAgIGJhY2tncm91bmQ6IHZhcigtLXRleHQpOwogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOwogICAgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93KTsKICAgIGNvbG9yOiB2YXIoLS1nbGFzcyk7Cn0KCiNmaWx0ZXJPcHRpb25zIHsKICAgIHBhZGRpbmc6IDAuODc1cmVtIDFyZW07CiAgICBib3JkZXI6IDA7CiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMpOwogICAgYmFja2dyb3VuZDogdmFyKC0tZ2xhc3MpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDIwcHgpOwogICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgZm9udC1zaXplOiAxNXB4OwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgb3V0bGluZTogbm9uZTsKICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7CiAgICBtaW4td2lkdGg6IDEzMHB4OwogICAgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93LXNtKTsKfQoKI2ZpbHRlck9wdGlvbnM6aG92ZXIgewogICAgYmFja2dyb3VuZDogdmFyKC0tdGV4dCk7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOwogICAgY29sb3I6IHZhcigtLWdsYXNzKTsKfQoKLmNvbnRyb2wtYnV0dG9ucyB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZ2FwOiAwLjVyZW07Cn0KCm1haW4gewogICAgbWFyZ2luOiAwIGF1dG87CiAgICBwYWRkaW5nOiAycmVtIDFyZW07CiAgICBwYWRkaW5nLWJvdHRvbTogNnJlbTsKfQoKI3pvbmVDb3VudCB7CiAgICBtYXJnaW46IDAgMCAxLjVyZW07CiAgICBmb250LXNpemU6IDE0cHg7CiAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICBmb250LXdlaWdodDogNjAwOwogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBnYXA6IDAuNXJlbTsKfQoKI3pvbmVDb3VudDo6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgd2lkdGg6IDRweDsKICAgIGhlaWdodDogNHB4OwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeSk7Cn0KCiNjb250YWluZXIsCiNmZWF0dXJlZFpvbmVzIHsKICAgIGRpc3BsYXk6IGdyaWQ7CiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdChhdXRvLWZpbGwsIG1pbm1heCgyMDBweCwgMWZyKSk7CiAgICBnYXA6IDEuNXJlbTsKfQoKLnpvbmUtaXRlbSB7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ncmFkaWVudC1zdXJmYWNlKTsKICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlcik7CiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtbGcpOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIHRyYW5zaXRpb246IGFsbCAwLjRzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zbSk7Cn0KCi56b25lLWl0ZW06aG92ZXIgewogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC04cHgpIHNjYWxlKDEuMDIpOwogICAgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93LXhsKTsKICAgIGJvcmRlci1jb2xvcjogdmFyKC0tcHJpbWFyeSk7Cn0KCi56b25lLWl0ZW06aG92ZXI6OmJlZm9yZSB7CiAgICBvcGFjaXR5OiAxOwp9Cgouem9uZS1pdGVtOjpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBpbnNldDogMDsKICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktbGlnaHQpOwogICAgb3BhY2l0eTogMDsKICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC40cyBlYXNlOwogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICB6LWluZGV4OiAxOwp9Cgouem9uZS1pdGVtIGltZyB7CiAgICB3aWR0aDogMTAwJTsKICAgIGFzcGVjdC1yYXRpbzogMTsKICAgIG9iamVjdC1maXQ6IGNvdmVyOwogICAgZGlzcGxheTogYmxvY2s7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ib3JkZXItbGlnaHQpOwogICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuNHMgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKfQoKLnpvbmUtaXRlbTpob3ZlciBpbWcgewogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjA1KTsKfQoKLnpvbmUtaXRlbSBidXR0b24gewogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7CiAgICBjb2xvcjogdmFyKC0tdGV4dCk7CiAgICBib3JkZXI6IDA7CiAgICBwYWRkaW5nOiAxLjI1cmVtIDFyZW07CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBmb250LXdlaWdodDogNjAwOwogICAgZm9udC1zaXplOiAxNHB4OwogICAgbGluZS1oZWlnaHQ6IDEuNDsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7CiAgICBtaW4taGVpZ2h0OiA3MHB4OwogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHotaW5kZXg6IDI7Cn0KCi56b25lLWl0ZW06aG92ZXIgYnV0dG9uIHsKICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5KTsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjUyLCAzOCwgODEsIDAuMDUpOwp9Cgojem9uZVZpZXdlciB7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICBpbnNldDogMDsKICAgIGJhY2tncm91bmQ6IHZhcigtLWJnKTsKICAgIHotaW5kZXg6IDEwMDA7CiAgICBkaXNwbGF5OiBub25lOwogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgIGFuaW1hdGlvbjogc2xpZGVJblVwIDAuM3MgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKfQoKQGtleWZyYW1lcyBzbGlkZUluVXAgewogICAgZnJvbSB7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwMCUpOwogICAgfQogICAgdG8gewogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsKICAgIH0KfQoKLnpvbmUtaGVhZGVyIHsKICAgIGJhY2tncm91bmQ6IHZhcigtLWdyYWRpZW50LXByaW1hcnkpOwogICAgY29sb3I6IHdoaXRlOwogICAgcGFkZGluZzogMXJlbSAxLjVyZW07CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1sZyk7Cn0KCi56b25lLXRpdGxlIHsKICAgIGZsZXg6IDE7CiAgICBtaW4td2lkdGg6IDA7Cn0KCiN6b25lTmFtZSB7CiAgICBmb250LXNpemU6IDEuMjVyZW07CiAgICBmb250LXdlaWdodDogNzAwOwogICAgbWFyZ2luOiAwIDAgMC4yNXJlbTsKICAgIGxpbmUtaGVpZ2h0OiAxLjM7Cn0KCiN6b25lSWQgewogICAgZGlzcGxheTogbm9uZTsKfQoKI3pvbmVBdXRob3IgewogICAgZm9udC1zaXplOiAxNHB4OwogICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC44KTsKICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTsKICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7CiAgICBmb250LXdlaWdodDogNTAwOwp9Cgojem9uZUF1dGhvcjpob3ZlciB7CiAgICBjb2xvcjogd2hpdGU7CiAgICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTsKfQoKLnpvbmUtY29udHJvbHMgewogICAgZGlzcGxheTogZmxleDsKICAgIGdhcDogMC43NXJlbTsKfQoKLnpvbmUtY29udHJvbHMgYnV0dG9uIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4zKTsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIHBhZGRpbmc6IDAuNjI1cmVtIDFyZW07CiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMpOwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgZm9udC1zaXplOiAxNHB4OwogICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7CiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMjBweCk7Cn0KCi56b25lLWNvbnRyb2xzIGJ1dHRvbjpob3ZlciB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7CiAgICBib3JkZXItY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC41KTsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsKICAgIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdyk7Cn0KCiN6b25lRnJhbWUgewogICAgZmxleC1ncm93OiAxOwogICAgYm9yZGVyOiBub25lOwogICAgd2lkdGg6IDkwJTsKICAgIGhlaWdodDogOTAlOwp9CgojcG9wdXBPdmVybGF5IHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIGluc2V0OiAwOwogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjYpOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDhweCk7CiAgICBkaXNwbGF5OiBub25lOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgei1pbmRleDogMjAwMDsKICAgIHBhZGRpbmc6IDFyZW07CiAgICBhbmltYXRpb246IGZhZGVJbiAwLjNzIGVhc2U7Cn0KCkBrZXlmcmFtZXMgZmFkZUluIHsKICAgIGZyb20gewogICAgICAgIG9wYWNpdHk6IDA7CiAgICB9CiAgICB0byB7CiAgICAgICAgb3BhY2l0eTogMTsKICAgIH0KfQoKLnBvcHVwIHsKICAgIGJhY2tncm91bmQ6IHZhcigtLXN1cmZhY2UpOwogICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLWxnKTsKICAgIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy14bCk7CiAgICB3aWR0aDogMTAwJTsKICAgIG1heC13aWR0aDogNTIwcHg7CiAgICBtYXgtaGVpZ2h0OiA4MHZoOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsKICAgIGFuaW1hdGlvbjogc2xpZGVJblNjYWxlIDAuM3MgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKfQoKQGtleWZyYW1lcyBzbGlkZUluU2NhbGUgewogICAgZnJvbSB7CiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgwLjkpIHRyYW5zbGF0ZVkoMjBweCk7CiAgICAgICAgb3BhY2l0eTogMDsKICAgIH0KICAgIHRvIHsKICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEpIHRyYW5zbGF0ZVkoMCk7CiAgICAgICAgb3BhY2l0eTogMTsKICAgIH0KfQoKLnBvcHVwLWhlYWRlciB7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1ncmFkaWVudC1wcmltYXJ5KTsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIHBhZGRpbmc6IDEuMjVyZW0gMS41cmVtOwogICAgZGlzcGxheTogZmxleDsKICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7Cn0KCiNwb3B1cFRpdGxlIHsKICAgIG1hcmdpbjogMDsKICAgIGZvbnQtc2l6ZTogMS4yNXJlbTsKICAgIGZvbnQtd2VpZ2h0OiA3MDA7Cn0KCiNwb3B1cENsb3NlIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgIGJvcmRlcjogMDsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIGZvbnQtc2l6ZTogMS4yNXJlbTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIHBhZGRpbmc6IDAuNXJlbTsKICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cyk7CiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBjdWJpYy1iZXppZXIoMC40LCAwLCAwLjIsIDEpOwogICAgbGluZS1oZWlnaHQ6IDE7CiAgICB3aWR0aDogMzZweDsKICAgIGhlaWdodDogMzZweDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMjBweCk7Cn0KCiNwb3B1cENsb3NlOmhvdmVyIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKfQoKI3BvcHVwQm9keSB7CiAgICBwYWRkaW5nOiAxLjVyZW07CiAgICBvdmVyZmxvdy15OiBhdXRvOwogICAgY29sb3I6IHZhcigtLXRleHQpOwp9CgojcG9wdXBCb2R5IGlucHV0W3R5cGU9InRleHQiXSwKI3BvcHVwQm9keSBpbnB1dFt0eXBlPSJmaWxlIl0gewogICAgd2lkdGg6IDEwMCU7CiAgICBwYWRkaW5nOiAwLjg3NXJlbSAxcmVtOwogICAgbWFyZ2luLWJvdHRvbTogMS4yNXJlbTsKICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlcik7CiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMpOwogICAgYmFja2dyb3VuZDogdmFyKC0tYmctc2Vjb25kYXJ5KTsKICAgIGNvbG9yOiB2YXIoLS10ZXh0KTsKICAgIGZvbnQtc2l6ZTogMTVweDsKICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7CiAgICBvdXRsaW5lOiBub25lOwp9CgojcG9wdXBCb2R5IGlucHV0W3R5cGU9InRleHQiXTpmb2N1cywKI3BvcHVwQm9keSBpbnB1dFt0eXBlPSJmaWxlIl06Zm9jdXMgewogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5KTsKICAgIGJveC1zaGFkb3c6IDAgMCAwIDNweCByZ2JhKDI1MiwgMzgsIDgxLCAwLjEpOwogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOwp9Cgpmb290ZXIgewogICAgYmFja2dyb3VuZDogdmFyKC0tYmctc2Vjb25kYXJ5KTsKICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOwogICAgcGFkZGluZzogMXJlbSAxcmVtOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwoKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIGJvdHRvbTogMDsKICAgIGxlZnQ6IDA7CiAgICB3aWR0aDogMTAwJTsKICAgIHotaW5kZXg6IDEwMDsKfQoKLmZvb3Rlci1saW5rcyB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICBnYXA6IDJyZW07CiAgICBmbGV4LXdyYXA6IHdyYXA7Cn0KCi5mb290ZXItbGlua3MgYSB7CiAgICBjb2xvcjogdmFyKC0tcHJpbWFyeSk7CiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7CiAgICBmb250LXdlaWdodDogNjAwOwogICAgZm9udC1zaXplOiAxNXB4OwogICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgY3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTsKICAgIHBhZGRpbmc6IDAuNXJlbSAxcmVtOwogICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzKTsKfQoKLmZvb3Rlci1saW5rcyBhOmhvdmVyIHsKICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWhvdmVyKTsKICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktbGlnaHQpOwogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOwp9CgpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsKICAgIC5oZWFkZXItY29udGVudCB7CiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICBnYXA6IDFyZW07CiAgICAgICAgcGFkZGluZzogMXJlbTsKICAgIH0KCiAgICAuc2VhcmNoLWNvbnRhaW5lciB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgbWF4LXdpZHRoOiBub25lOwogICAgfQoKICAgIG1haW4gewogICAgICAgIHBhZGRpbmc6IDEuNXJlbSAxcmVtOwogICAgfQoKICAgICNjb250YWluZXIsCiAgICAjZmVhdHVyZWRab25lcyB7CiAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maWxsLCBtaW5tYXgoMTYwcHgsIDFmcikpOwogICAgICAgIGdhcDogMS4yNXJlbTsKICAgIH0KCiAgICAuem9uZS1pdGVtIGJ1dHRvbiB7CiAgICAgICAgcGFkZGluZzogMXJlbSAwLjc1cmVtOwogICAgICAgIG1pbi1oZWlnaHQ6IDY1cHg7CiAgICAgICAgZm9udC1zaXplOiAxM3B4OwogICAgfQoKICAgIC5mb290ZXItbGlua3MgewogICAgICAgIGdhcDogMS41cmVtOwogICAgfQp9CgpAbWVkaWEgKG1heC13aWR0aDogNDgwcHgpIHsKICAgICNjb250YWluZXIsCiAgICAjZmVhdHVyZWRab25lcyB7CiAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maWxsLCBtaW5tYXgoMTQwcHgsIDFmcikpOwogICAgICAgIGdhcDogMXJlbTsKICAgIH0KCiAgICAucG9wdXAgewogICAgICAgIG1hcmdpbjogMC41cmVtOwogICAgfQoKICAgIC56b25lLWl0ZW06aG92ZXIgewogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTBweCkgc2NhbGUoMS4wMSk7CiAgICB9Cgp9Ci5jb250cm9sLWJ1dHRvbiBpbWcgewogICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuNHMgZWFzZTsKICAgIHdpZHRoOiAyNHB4OwogICAgaGVpZ2h0OiAyNHB4Owp9CgouY29udHJvbC1idXR0b246aG92ZXIgaW1nIHsKICAgIHRyYW5zZm9ybTogcm90YXRlKDQwZGVnKTsKfQoKLmNvbnRyb2wtYnV0dG9uLAouY29udHJvbC1idXR0b246aG92ZXIgewogICAgYm94LXNoYWRvdzogbm9uZTsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMnB4KTsKICAgIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1sZyk7Cn0KLmNvbnRyb2wtYnV0dG9uOmFjdGl2ZSB7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7Cn0KCi5jb250cm9sLWJ1dHRvbnMgYnV0dG9uIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgIGJvcmRlcjogMDsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIHBhZGRpbmc6IDA7CiAgICB3aWR0aDogNDRweDsKICAgIGhlaWdodDogNDRweDsKICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cyk7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDIwcHgpOwp9Ci5jb250cm9sLWJ1dHRvbnMgYnV0dG9uOmhvdmVyIHsKICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKfQouc2V0dGluZ3MtYnV0dG9uIHsKICAgIGJhY2tncm91bmQ6IHZhcigtLWdyYWRpZW50LXByaW1hcnkpOwogICAgY29sb3I6IHdoaXRlOwogICAgYm9yZGVyOiAwOwogICAgcGFkZGluZzogMC44NzVyZW0gMS41cmVtOwogICAgZm9udC1zaXplOiAxNXB4OwogICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cyk7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBjdWJpYy1iZXppZXIoMC40LCAwLCAwLjIsIDEpOwogICAgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93LXNtKTsKICAgIG1pbi13aWR0aDogMjAwcHg7CiAgICB3aWR0aDogMTAwJTsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKfQoKLnNldHRpbmdzLWJ1dHRvbjpob3ZlciB7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCk7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctbGcpOwp9Cgouc2V0dGluZ3MtYnV0dG9uOmFjdGl2ZSB7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc20pOwp9CgouaW5mby1idXR0b24gewogICAgYmFja2dyb3VuZDogbm9uZTsKICAgIGJvcmRlcjogbm9uZTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIHBhZGRpbmc6IDA7CiAgICBtYXJnaW4tbGVmdDogMTBweDsKICAgIGRpc3BsYXk6IGlubGluZS1mbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgd2lkdGg6IDI0cHg7CiAgICBoZWlnaHQ6IDI0cHg7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMsIHRyYW5zZm9ybSAwLjJzOwogICAgY29sb3I6IGluaGVyaXQ7CiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwp9CgouaW5mby1idXR0b246aG92ZXIgewogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwp9CgouaW5mby1idXR0b246YWN0aXZlIHsKICAgIHRyYW5zZm9ybTogc2NhbGUoMC45NSk7Cn0KCi5pbmZvLWJ1dHRvbiBzdmcgewogICAgZGlzcGxheTogYmxvY2s7Cn0gICAgCi5hZC16b25lLWl0ZW0gewogICAgYmFja2dyb3VuZDogdmFyKC0tZ3JhZGllbnQtc3VyZmFjZSk7CiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS13YXJuaW5nKTsKICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1sZyk7CiAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgZGlzcGxheTogZmxleDsKICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc20pOwogICAgY3Vyc29yOiBkZWZhdWx0OwogICAgZ3JpZC1jb2x1bW46IHNwYW4gMTsKfQoKLmFkLXpvbmUtaXRlbSAuYWQtbGFiZWwgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgdG9wOiA4cHg7CiAgICByaWdodDogOHB4OwogICAgYmFja2dyb3VuZDogdmFyKC0td2FybmluZyk7CiAgICBjb2xvcjogIzAwMDsKICAgIGZvbnQtc2l6ZTogMTJweDsKICAgIGZvbnQtd2VpZ2h0OiA4MDA7CiAgICBwYWRkaW5nOiA0cHggMTBweDsKICAgIGJvcmRlci1yYWRpdXM6IDZweDsKICAgIHotaW5kZXg6IDEwOwogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOwogICAgbGV0dGVyLXNwYWNpbmc6IDAuNXB4Owp9CgouYWQtem9uZS1pdGVtIC5hZC1jb250ZW50IHsKICAgIHdpZHRoOiAxMDAlOwogICAgYXNwZWN0LXJhdGlvOiAxOwogICAgZGlzcGxheTogZmxleDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGJhY2tncm91bmQ6IHZhcigtLWJnLXNlY29uZGFyeSk7CiAgICBwYWRkaW5nOiAxcmVtOwp9Cgo8L3N0eWxlPgogICAgPGxpbmsgcmVsPSJtYW5pZmVzdCIgaHJlZj0ibWFuaWZlc3QuanNvbiI+CiAgICA8bWV0YSBuYW1lPSJ0aGVtZS1jb2xvciIgY29udGVudD0iI2ZiMjY1MSI+CjwvaGVhZD4KPGJvZHkgY2xhc3M9ImRhcmstbW9kZSI+CiAgICA8aGVhZGVyPgogICAgICAgIDxkaXYgY2xhc3M9ImhlYWRlci1jb250ZW50Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibG9nbyI+Z24tbWF0aDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWFyY2gtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0ic2VhcmNoQmFyIiBwbGFjZWhvbGRlcj0iU2VhcmNoIHpvbmVzLi4uIiBvbmlucHV0PSJmaWx0ZXJab25lcygpIj4KICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9InNvcnRPcHRpb25zIiBvbmNoYW5nZT0ic29ydFpvbmVzKCkiPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im5hbWUiPk5hbWU8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJpZCI+SUQgKERhdGUpPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0icG9wdWxhciI+UG9wdWxhcjwvb3B0aW9uPgogICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSJmaWx0ZXJPcHRpb25zIiBvbmNoYW5nZT0iZmlsdGVyWm9uZXMyKCkiPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im5vbmUiPihTRUxFQ1QgVEFHKTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb250cm9sLWJ1dHRvbnMiPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0icmVmcmVzaCIgY2xhc3M9ImNvbnRyb2wtYnV0dG9uIiB0aXRsZT0iUmVmcmVzaCBhbGwgdGhlIHpvbmVzIiBvbmNsaWNrPSJsaXN0Wm9uZXMoKSI+CiAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9InJlZnJlc2gtaWNvbi5wbmciIGFsdD0icmVmcmVzaCI+CiAgICAgICAgICAgICAgICA8L2J1dHRvbj4KCiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJzZXR0aW5ncyIgY2xhc3M9ImNvbnRyb2wtYnV0dG9uIiB0aXRsZT0iU2V0dGluZ3MhIj4KICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0ic2V0dGluZy5wbmciIGFsdD0ic2V0dGluZ3MiPgogICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgPC9oZWFkZXI+CjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4gKHdhcFRhZy5Jbml0ID0gd2luZG93LndhcFRhZy5Jbml0IHx8IFtdKS5wdXNoKGZ1bmN0aW9uICgpIHsgd0FQSVRhZy5pbml0U3RpY2t5QmFubmVyKCJwd180OTc1MyIpOyB9KTsgPC9zY3JpcHQ+Cgk8bWFpbj4KICAgIDxicj4KICAgICAgICA8ZGV0YWlscyBpZD0iZmVhdHVyZWRab25lc1dyYXBwZXIiIG9wZW4+CiAgICAgICAgICAgIDxzdW1tYXJ5IGlkPSJhbGxab25lc1N1bW1hcnkiIHN0eWxlPSJmb250LXNpemU6IDEuMnJlbTsgZm9udC13ZWlnaHQ6IGJvbGQ7IGN1cnNvcjogcG9pbnRlcjsiPkZlYXR1cmVkIFpvbmVzPC9zdW1tYXJ5PgogICAgICAgICAgICA8ZGl2IGlkPSJmZWF0dXJlZFpvbmVzIiBjbGFzcz0iem9uZS1jb250YWluZXIiPjwvZGl2PgogICAgICAgIDwvZGV0YWlscz4KICAgICAgICA8YnI+PGhyPjxicj4KPGJyPgogICAgICAgIDxkZXRhaWxzIGlkPSJhbGxab25lc1dyYXBwZXIiIG9wZW4+CiAgICAgICAgICAgIDxzdW1tYXJ5IGlkPSJhbGxTdW1tYXJ5IiBzdHlsZT0iZm9udC1zaXplOiAxLjJyZW07IGZvbnQtd2VpZ2h0OiBib2xkOyBjdXJzb3I6IHBvaW50ZXI7Ij5BbGwgWm9uZXM8L3N1bW1hcnk+CiAgICAgICAgICAgIDxkaXYgaWQ9ImNvbnRhaW5lciI+TG9hZGluZy4uLjwvZGl2PgogICAgICAgIDwvZGV0YWlscz4KICAgIDwvbWFpbj4KCiAgICAgPGRpdiBpZD0iem9uZVZpZXdlciI+CiAgICAgICAgPGRpdiBjbGFzcz0iem9uZS1oZWFkZXIiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ6b25lLXRpdGxlIj4KICAgICAgICAgICAgICAgIDxoMiBpZD0iem9uZU5hbWUiPnpvbmU8L2gyPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iaW5mby1idXR0b24iIG9uY2xpY2s9InNob3dab25lSW5mbygpIiB0aXRsZT0iWm9uZSBJbmZvcm1hdGlvbiI+CiAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPgogICAgICAgICAgICAgICAgICAgICAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCI+PC9jaXJjbGU+CiAgICAgICAgICAgICAgICAgICAgICAgIDxsaW5lIHgxPSIxMiIgeTE9IjE2IiB4Mj0iMTIiIHkyPSIxMiI+PC9saW5lPgogICAgICAgICAgICAgICAgICAgICAgICA8bGluZSB4MT0iMTIiIHkxPSI4IiB4Mj0iMTIuMDEiIHkyPSI4Ij48L2xpbmU+CiAgICAgICAgICAgICAgICAgICAgPC9zdmc+CiAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDxzcGFuIGlkPSJ6b25lSWQiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+PC9zcGFuPgogICAgICAgICAgICAgICAgPGEgaWQ9InpvbmVBdXRob3IiIGhyZWY9IiMiIHRhcmdldD0iX2JsYW5rIj5ieSBBdXRob3I8L2E+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ6b25lLWNvbnRyb2xzIj4KICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iZnVsbHNjcmVlblpvbmUoKSI+RnVsbHNjcmVlbjwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJhYm91dEJsYW5rKCkiPk9wZW4gaW4gTmV3IFRhYjwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJkb3dubG9hZFpvbmUoKSI+RG93bmxvYWQ8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iY2xvc2Vab25lKCkiPkNsb3NlPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICAgIDxpZnJhbWUgaWQ9InpvbmVGcmFtZSI+PC9pZnJhbWU+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGlkPSJwb3B1cE92ZXJsYXkiPgogICAgICAgIDxkaXYgY2xhc3M9InBvcHVwIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0icG9wdXAtaGVhZGVyIj4KICAgICAgICAgICAgICAgIDxoMyBpZD0icG9wdXBUaXRsZSI+VGl0bGU8L2gzPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0icG9wdXBDbG9zZSIgb25jbGljaz0iY2xvc2VQb3B1cCgpIj7vv708L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgaWQ9InBvcHVwQm9keSI+CiAgICAgICAgICAgICAgICBDb250ZW50IHdpbGwgYmUgaGVyZQogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImZvb3Rlci1saW5rcyI+CiAgICAgICAgICAgIDxhIGhyZWY9IiMiIG9uY2xpY2s9ImxvYWRETUNBKCk7IHJldHVybiBmYWxzZTsiPkRNQ0E8L2E+CiAgICAgICAgICAgIDxhIGhyZWY9IiMiIG9uY2xpY2s9InNob3dDb250YWN0KCk7IHJldHVybiBmYWxzZTsiPkNvbnRhY3Q8L2E+CiAgICAgICAgICAgIDxhIGhyZWY9IiMiIG9uY2xpY2s9ImxvYWRQcml2YWN5KCk7IHJldHVybiBmYWxzZTsiPlByaXZhY3kgUG9saWN5PC9hPgogICAgICAgICAgICA8YSBocmVmPSJqYXZhc2NyaXB0OnNhdmVEYXRhKCkiPkV4cG9ydCBEYXRhPC9hPgogICAgICAgICAgICA8YSBocmVmPSIjIiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1wb3J0RGF0YScpLmNsaWNrKCk7IHJldHVybiBmYWxzZTsiPkltcG9ydCBEYXRhPC9hPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0iZmlsZSIgaWQ9ImltcG9ydERhdGEiIHN0eWxlPSJkaXNwbGF5OiBub25lOyIgb25jaGFuZ2U9ImxvYWREYXRhKGV2ZW50KSI+CiAgICAgICAgPC9kaXY+CiAgICA8L2Zvb3Rlcj4KICAgIDxzY3JpcHQ+Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhaW5lcicpOwpjb25zdCB6b25lVmlld2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvbmVWaWV3ZXInKTsKbGV0IHpvbmVGcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b25lRnJhbWUnKTsKY29uc3Qgc2VhcmNoQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaEJhcicpOwpjb25zdCBzb3J0T3B0aW9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3J0T3B0aW9ucycpOwpjb25zdCBmaWx0ZXJPcHRpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlck9wdGlvbnMnKTsKLy8gaHR0cHM6Ly93d3cuanNkZWxpdnIuY29tL3Rvb2xzL3B1cmdlCmNvbnN0IHpvbmVzdXJscyA9IFsKICAgICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvJTY3JTY4LyU2NyU2ZSUyZCU2ZCU2MSU3NCU2OC8lNjElNzMlNzMlNjUlNzQlNzNAJTZkJTYxJTY5JTZlLyU3YSU2ZiU2ZSU2NSU3MyUyZSU2YSU3MyU2ZiU2ZSIsCiAgICAiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2duLW1hdGgvYXNzZXRzQGxhdGVzdC96b25lcy5qc29uIiwKICAgICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvZ24tbWF0aC9hc3NldHNAbWFzdGVyL3pvbmVzLmpzb24iLAogICAgImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9nbi1tYXRoL2Fzc2V0cy96b25lcy5qc29uIgpdOwpsZXQgem9uZXNVUkwgPSB6b25lc3VybHNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogem9uZXN1cmxzLmxlbmd0aCldOwpjb25zdCBjb3ZlclVSTCA9ICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvZ24tbWF0aC9jb3ZlcnNAbWFpbiI7CmNvbnN0IGh0bWxVUkwgPSAiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2duLW1hdGgvaHRtbEBtYWluIjsKbGV0IHpvbmVzID0gW107CmxldCBwb3B1bGFyaXR5RGF0YSA9IHt9Owpjb25zdCBmZWF0dXJlZENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmZWF0dXJlZFpvbmVzJyk7CmZ1bmN0aW9uIHRvVGl0bGVDYXNlKHN0cikgewogIHJldHVybiBzdHIucmVwbGFjZSgKICAgIC9cd1xTKi9nLAogICAgdGV4dCA9PiB0ZXh0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGV4dC5zdWJzdHJpbmcoMSkudG9Mb3dlckNhc2UoKQogICk7Cn0KYXN5bmMgZnVuY3Rpb24gbGlzdFpvbmVzKCkgewogICAgdHJ5IHsKICAgICAgbGV0IHNoYXJlc3BvbnNlOwogICAgICBsZXQgc2hhanNvbjsKICAgICAgbGV0IHNoYTsKICAgICAgICB0cnkgewogICAgICAgICAgc2hhcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9nbi1tYXRoL2Fzc2V0cy9jb21taXRzP3Q9IitEYXRlLm5vdygpKTsKICAgICAgICB9IGNhdGNoIChlcnJvcikge30KICAgICAgICBpZiAoc2hhcmVzcG9uc2UgJiYgc2hhcmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNoYWpzb24gPSBhd2FpdCBzaGFyZXNwb25zZS5qc29uKCk7CiAgICAgICAgICAgIHNoYSA9IHNoYWpzb25bMF1bJ3NoYSddOwogICAgICAgICAgICBpZiAoc2hhKSB7CiAgICAgICAgICAgICAgICB6b25lc1VSTCA9IGBodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvZ24tbWF0aC9hc3NldHNAJHtzaGF9L3pvbmVzLmpzb25gOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbGV0IHNlY29uZGFyeXNoYXJlc3BvbnNlID0gYXdhaXQgZmV0Y2goImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9nbi1tYXRoL3htbC9yZWZzL2hlYWRzL21haW4vc2hhLnR4dD90PSIrRGF0ZS5ub3coKSk7CiAgICAgICAgICAgICAgICBpZiAoc2Vjb25kYXJ5c2hhcmVzcG9uc2UgJiYgc2Vjb25kYXJ5c2hhcmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICBzaGEgPSAoYXdhaXQgc2Vjb25kYXJ5c2hhcmVzcG9uc2UudGV4dCgpKS50cmltKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHNoYSkgewogICAgICAgICAgICAgICAgICAgICAgICB6b25lc1VSTCA9IGBodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvZ24tbWF0aC9hc3NldHNAJHtzaGF9L3pvbmVzLmpzb25gOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaChlcnJvcikge30KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh6b25lc1VSTCsiP3Q9IitEYXRlLm5vdygpKTsKICAgICAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOwogICAgICAgIHpvbmVzID0ganNvbjsKICAgICAgICB6b25lc1swXS5mZWF0dXJlZCA9IHRydWU7IC8vIGFsd2F5cyBnb25uYSBiZSB0aGUgZGlzY29yZAogICAgICAgIGF3YWl0IGZldGNoUG9wdWxhcml0eSgpOwogICAgICAgIHNvcnRab25lcygpOwogICAgICAgIGNvbnN0IHNlYXJjaCA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7CiAgICAgICAgY29uc3QgaWQgPSBzZWFyY2guZ2V0KCdpZCcpOwogICAgICAgIGNvbnN0IGVtYmVkID0gd2luZG93LmxvY2F0aW9uLmhhc2guaW5jbHVkZXMoImVtYmVkIik7CiAgICAgICAgaWYgKGlkKSB7CiAgICAgICAgICAgIGNvbnN0IHpvbmUgPSB6b25lcy5maW5kKHpvbmUgPT4gem9uZS5pZCArICcnID09IGlkICsgJycpOwogICAgICAgICAgICBpZiAoem9uZSkgewogICAgICAgICAgICAgICAgaWYgKGVtYmVkKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHpvbmUudXJsLnN0YXJ0c1dpdGgoImh0dHAiKSkgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cub3Blbih6b25lLnVybCwgIl9ibGFuayIpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IHpvbmUudXJsLnJlcGxhY2UoIntDT1ZFUl9VUkx9IiwgY292ZXJVUkwpLnJlcGxhY2UoIntIVE1MX1VSTH0iLCBodG1sVVJMKTsKICAgICAgICAgICAgICAgICAgICAgICAgZmV0Y2godXJsKyI/dD0iK0RhdGUubm93KCkpLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UudGV4dCgpKS50aGVuKGh0bWwgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmlubmVySFRNTCA9IGh0bWw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuc3R5bGUucG9zaXRpb24gPSAiZml4ZWQiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuc3R5bGUuYm90dG9tID0gIjIwcHgiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuc3R5bGUucmlnaHQgPSAiMjBweCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAiI2NjZTVmZiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5zdHlsZS5jb2xvciA9ICIjMDA0MDg1IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwLnN0eWxlLnBhZGRpbmcgPSAiMTBweCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5zdHlsZS5ib3JkZXIgPSAiMXB4IHNvbGlkICNiOGRhZmYiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuc3R5bGUuYm9yZGVyUmFkaXVzID0gIjVweCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5zdHlsZS5ib3hTaGFkb3cgPSAiMHB4IDBweCAxMHB4IHJnYmEoMCwwLDAsMC4xKSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cC5zdHlsZS5mb250RmFtaWx5ID0gIkFyaWFsLCBzYW5zLXNlcmlmIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXAuaW5uZXJIVE1MID0gYFBsYXkgbW9yZSBnYW1lcyBhdCA8YSBocmVmPSJodHRwczovL2duLW1hdGguZ2l0aHViLmlvIiB0YXJnZXQ9Il9ibGFuayIgc3R5bGU9ImNvbG9yOiMwMDQwODU7IGZvbnQtd2VpZ2h0OmJvbGQ7Ij5odHRwczovL2duLW1hdGguZ2l0aHViLmlvPC9hPiFgOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VCdG4uaW5uZXJUZXh0ID0gIj8iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VCdG4uc3R5bGUubWFyZ2luTGVmdCA9ICIxMHB4IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAibm9uZSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZUJ0bi5zdHlsZS5ib3JkZXIgPSAibm9uZSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZUJ0bi5zdHlsZS5jdXJzb3IgPSAicG9pbnRlciI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZUJ0bi5zdHlsZS5jb2xvciA9ICIjMDA0MDg1IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlQnRuLnN0eWxlLmZvbnRXZWlnaHQgPSAiYm9sZCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlQnRuLm9uY2xpY2sgPSAoKSA9PiBwb3B1cC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwLmFwcGVuZENoaWxkKGNsb3NlQnRuKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocG9wdXApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3NjcmlwdCcpLmZvckVhY2gob2xkU2NyaXB0ID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdTY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2xkU2NyaXB0LnNyYykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdTY3JpcHQuc3JjID0gb2xkU2NyaXB0LnNyYzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdTY3JpcHQudGV4dENvbnRlbnQgPSBvbGRTY3JpcHQudGV4dENvbnRlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobmV3U2NyaXB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChlcnJvciA9PiBhbGVydCgiRmFpbGVkIHRvIGxvYWQgem9uZTogIiArIGVycm9yKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBvcGVuWm9uZSh6b25lKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbGV0IGFsbHRhZ3MgPSBbXTsKICAgICAgICBmb3IgKGNvbnN0IG9iaiBvZiBqc29uKSB7CiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KG9iai5zcGVjaWFsKSkgewogICAgICAgICAgICAgICAgYWxsdGFncy5wdXNoKC4uLm9iai5zcGVjaWFsKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYWxsdGFncyA9IFsuLi5uZXcgU2V0KGFsbHRhZ3MpXTsKICAgICAgICBsZXQgZmlsdGVyb3B0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZpbHRlck9wdGlvbnMiKTsKICAgICAgICBpZiAoZmlsdGVyb3B0aW9uICYmIGZpbHRlcm9wdGlvbi5jaGlsZHJlbi5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgIHdoaWxlIChmaWx0ZXJvcHRpb24uY2hpbGRyZW4ubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgICAgZmlsdGVyb3B0aW9uLnJlbW92ZUNoaWxkKGZpbHRlcm9wdGlvbi5sYXN0RWxlbWVudENoaWxkKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBmb3IgKGNvbnN0IHRhZyBvZiBhbGx0YWdzKSB7CiAgICAgICAgICAgIGNvbnN0IG9wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOwogICAgICAgICAgICBvcHQudmFsdWUgPSB0YWc7CiAgICAgICAgICAgIG9wdC50ZXh0Q29udGVudCA9IHRvVGl0bGVDYXNlKHRhZyk7CiAgICAgICAgICAgIGZpbHRlcm9wdGlvbi5hcHBlbmRDaGlsZChvcHQpOwogICAgICAgIH0KICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGBFcnJvciBsb2FkaW5nIHpvbmVzOiAke2Vycm9yfWA7CiAgICB9Cn0KYXN5bmMgZnVuY3Rpb24gZmV0Y2hQb3B1bGFyaXR5KCkgewogICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCJodHRwczovL2RhdGEuanNkZWxpdnIuY29tL3YxL3N0YXRzL3BhY2thZ2VzL2doL2duLW1hdGgvaHRtbEBtYWluL2ZpbGVzP3BlcmlvZD15ZWFyIik7CiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgICAgICBkYXRhLmZvckVhY2goZmlsZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGlkTWF0Y2ggPSBmaWxlLm5hbWUubWF0Y2goL1wvKFxkKylcLmh0bWwkLyk7CiAgICAgICAgICAgIGlmIChpZE1hdGNoKSB7CiAgICAgICAgICAgICAgICBjb25zdCBpZCA9IHBhcnNlSW50KGlkTWF0Y2hbMV0pOwogICAgICAgICAgICAgICAgcG9wdWxhcml0eURhdGFbaWRdID0gZmlsZS5oaXRzLnRvdGFsOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHBvcHVsYXJpdHlEYXRhWzBdID0gMDsKICAgIH0KfQoKZnVuY3Rpb24gc29ydFpvbmVzKCkgewogICAgY29uc3Qgc29ydEJ5ID0gc29ydE9wdGlvbnMudmFsdWU7CiAgICBpZiAoc29ydEJ5ID09PSAnbmFtZScpIHsKICAgICAgICB6b25lcy5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTsKICAgIH0gZWxzZSBpZiAoc29ydEJ5ID09PSAnaWQnKSB7CiAgICAgICAgem9uZXMuc29ydCgoYSwgYikgPT4gYS5pZCAtIGIuaWQpOwogICAgfSBlbHNlIGlmIChzb3J0QnkgPT09ICdwb3B1bGFyJykgewogICAgICAgIHpvbmVzLnNvcnQoKGEsIGIpID0+IChwb3B1bGFyaXR5RGF0YVtiLmlkXSB8fCAwKSAtIChwb3B1bGFyaXR5RGF0YVthLmlkXSB8fCAwKSk7CiAgICB9CiAgICB6b25lcy5zb3J0KChhLCBiKSA9PiAoYS5pZCA9PT0gLTEgPyAtMSA6IGIuaWQgPT09IC0xID8gMSA6IDApKTsKICAgIGlmIChmZWF0dXJlZENvbnRhaW5lci5pbm5lckhUTUwgPT09ICIiKSB7CiAgICAgICAgY29uc3QgZmVhdHVyZWQgPSB6b25lcy5maWx0ZXIoeiA9PiB6LmZlYXR1cmVkKTsKICAgICAgICBkaXNwbGF5RmVhdHVyZWRab25lcyhmZWF0dXJlZCk7CiAgICB9CiAgICBkaXNwbGF5Wm9uZXMoem9uZXMpOwp9CgpmdW5jdGlvbiBkaXNwbGF5RmVhdHVyZWRab25lcyhmZWF0dXJlZFpvbmVzKSB7CiAgICBmZWF0dXJlZENvbnRhaW5lci5pbm5lckhUTUwgPSAiIjsKICAgIGZlYXR1cmVkWm9uZXMuZm9yRWFjaCgoZmlsZSwgaW5kZXgpID0+IHsKICAgICAgICBjb25zdCB6b25lSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgIHpvbmVJdGVtLmNsYXNzTmFtZSA9ICJ6b25lLWl0ZW0iOwogICAgICAgIHpvbmVJdGVtLm9uY2xpY2sgPSAoKSA9PiBvcGVuWm9uZShmaWxlKTsKICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbWciKTsKICAgICAgICBpbWcuZGF0YXNldC5zcmMgPSBmaWxlLmNvdmVyLnJlcGxhY2UoIntDT1ZFUl9VUkx9IiwgY292ZXJVUkwpLnJlcGxhY2UoIntIVE1MX1VSTH0iLCBodG1sVVJMKTsKICAgICAgICBpbWcuYWx0ID0gZmlsZS5uYW1lOwogICAgICAgIGltZy5sb2FkaW5nID0gImxhenkiOwogICAgICAgIGltZy5jbGFzc05hbWUgPSAibGF6eS16b25lLWltZyI7CiAgICAgICAgem9uZUl0ZW0uYXBwZW5kQ2hpbGQoaW1nKTsKICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSBmaWxlLm5hbWU7CiAgICAgICAgYnV0dG9uLm9uY2xpY2sgPSAoZXZlbnQpID0+IHsKICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgIG9wZW5ab25lKGZpbGUpOwogICAgICAgIH07CiAgICAgICAgem9uZUl0ZW0uYXBwZW5kQ2hpbGQoYnV0dG9uKTsKICAgICAgICBmZWF0dXJlZENvbnRhaW5lci5hcHBlbmRDaGlsZCh6b25lSXRlbSk7CiAgICB9KTsKICAgIGlmIChmZWF0dXJlZENvbnRhaW5lci5pbm5lckhUTUwgPT09ICIiKSB7CiAgICAgICAgZmVhdHVyZWRDb250YWluZXIuaW5uZXJIVE1MID0gIk5vIGZlYXR1cmVkIHpvbmVzIGZvdW5kLiI7CiAgICB9IGVsc2UgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhbGxab25lc1N1bW1hcnkiKS50ZXh0Q29udGVudCA9IGBGZWF0dXJlZCBab25lcyAoJHtmZWF0dXJlZFpvbmVzLmxlbmd0aH0pYDsKICAgIH0KCiAgICBjb25zdCBsYXp5SW1hZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2ZlYXR1cmVkWm9uZXMgaW1nLmxhenktem9uZS1pbWcnKTsKICAgIGNvbnN0IGltYWdlT2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoKGVudHJpZXMsIG9ic2VydmVyKSA9PiB7CiAgICAgICAgZW50cmllcy5mb3JFYWNoKGVudHJ5ID0+IHsKICAgICAgICAgICAgaWYgKGVudHJ5LmlzSW50ZXJzZWN0aW5nICYmICF6b25lVmlld2VyLmhpZGRlbikgewogICAgICAgICAgICAgICAgY29uc3QgaW1nID0gZW50cnkudGFyZ2V0OwogICAgICAgICAgICAgICAgaW1nLnNyYyA9IGltZy5kYXRhc2V0LnNyYzsKICAgICAgICAgICAgICAgIGltZy5jbGFzc0xpc3QucmVtb3ZlKCJsYXp5LXpvbmUtaW1nIik7CiAgICAgICAgICAgICAgICBvYnNlcnZlci51bm9ic2VydmUoaW1nKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwgewogICAgICAgIHJvb3RNYXJnaW46ICIxMDBweCIsIAogICAgICAgIHRocmVzaG9sZDogMC4xCiAgICB9KTsKCiAgICBsYXp5SW1hZ2VzLmZvckVhY2goaW1nID0+IHsKICAgICAgICBpbWFnZU9ic2VydmVyLm9ic2VydmUoaW1nKTsKICAgIH0pOwp9CmZ1bmN0aW9uIGRpc3BsYXlab25lcyh6b25lcykgewogICAgY29udGFpbmVyLmlubmVySFRNTCA9ICIiOwoKICAgIHpvbmVzLmZvckVhY2goKGZpbGUsIGluZGV4KSA9PiB7CiAgICAgICAgY29uc3Qgem9uZUl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICB6b25lSXRlbS5jbGFzc05hbWUgPSAiem9uZS1pdGVtIjsKICAgICAgICB6b25lSXRlbS5vbmNsaWNrID0gKCkgPT4gb3BlblpvbmUoZmlsZSk7CgogICAgICAgIGNvbnN0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImltZyIpOwogICAgICAgIGltZy5kYXRhc2V0LnNyYyA9IGZpbGUuY292ZXIKICAgICAgICAgICAgLnJlcGxhY2UoIntDT1ZFUl9VUkx9IiwgY292ZXJVUkwpCiAgICAgICAgICAgIC5yZXBsYWNlKCJ7SFRNTF9VUkx9IiwgaHRtbFVSTCk7CiAgICAgICAgaW1nLmFsdCA9IGZpbGUubmFtZTsKICAgICAgICBpbWcubG9hZGluZyA9ICJsYXp5IjsKICAgICAgICBpbWcuY2xhc3NOYW1lID0gImxhenktem9uZS1pbWciOwogICAgICAgIHpvbmVJdGVtLmFwcGVuZENoaWxkKGltZyk7CgogICAgICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IGZpbGUubmFtZTsKICAgICAgICBidXR0b24ub25jbGljayA9IChlKSA9PiB7CiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgIG9wZW5ab25lKGZpbGUpOwogICAgICAgIH07CiAgICAgICAgem9uZUl0ZW0uYXBwZW5kQ2hpbGQoYnV0dG9uKTsKCiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHpvbmVJdGVtKTsKICAgIH0pOwoKICAgIGlmICghem9uZXMubGVuZ3RoKSB7CiAgICAgICAgY29udGFpbmVyLnRleHRDb250ZW50ID0gIk5vIHpvbmVzIGZvdW5kLiI7CiAgICB9IGVsc2UgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhbGxTdW1tYXJ5IikudGV4dENvbnRlbnQgPQogICAgICAgICAgICBgQWxsIFpvbmVzICgke3pvbmVzLmxlbmd0aH0pYDsKICAgIH0KCiAgICBjb25zdCBsYXp5SW1hZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiaW1nLmxhenktem9uZS1pbWciKTsKICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzLCBvYnMpID0+IHsKICAgICAgICBlbnRyaWVzLmZvckVhY2goZW50cnkgPT4gewogICAgICAgICAgICBpZiAoZW50cnkuaXNJbnRlcnNlY3RpbmcgJiYgIXpvbmVWaWV3ZXIuaGlkZGVuKSB7CiAgICAgICAgICAgICAgICBjb25zdCBpbWcgPSBlbnRyeS50YXJnZXQ7CiAgICAgICAgICAgICAgICBpbWcuc3JjID0gaW1nLmRhdGFzZXQuc3JjOwogICAgICAgICAgICAgICAgaW1nLmNsYXNzTGlzdC5yZW1vdmUoImxhenktem9uZS1pbWciKTsKICAgICAgICAgICAgICAgIG9icy51bm9ic2VydmUoaW1nKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwgeyByb290TWFyZ2luOiAiMTAwcHgiIH0pOwoKICAgIGxhenlJbWFnZXMuZm9yRWFjaChpbWcgPT4gb2JzZXJ2ZXIub2JzZXJ2ZShpbWcpKTsKfQoKZnVuY3Rpb24gZmlsdGVyWm9uZXMyKCkgewogICAgY29uc3QgcXVlcnkgPSBmaWx0ZXJPcHRpb25zLnZhbHVlOwogICAgaWYgKHF1ZXJ5ID09PSAibm9uZSIpIHsKICAgICAgICBkaXNwbGF5Wm9uZXMoem9uZXMpOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBmaWx0ZXJlZFpvbmVzID0gem9uZXMuZmlsdGVyKHpvbmUgPT4gem9uZS5zcGVjaWFsPy5pbmNsdWRlcyhxdWVyeSkpOwogICAgICAgIGlmIChxdWVyeS5sZW5ndGggIT09IDApIHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZlYXR1cmVkWm9uZXNXcmFwcGVyIikucmVtb3ZlQXR0cmlidXRlKCJvcGVuIik7CiAgICAgICAgfQogICAgICAgIGRpc3BsYXlab25lcyhmaWx0ZXJlZFpvbmVzKTsKICAgIH0KfQoKZnVuY3Rpb24gZmlsdGVyWm9uZXMoKSB7CiAgICBjb25zdCBxdWVyeSA9IHNlYXJjaEJhci52YWx1ZS50b0xvd2VyQ2FzZSgpOwogICAgY29uc3QgZmlsdGVyZWRab25lcyA9IHpvbmVzLmZpbHRlcih6b25lID0+IHpvbmUubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KSk7CiAgICBpZiAocXVlcnkubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZlYXR1cmVkWm9uZXNXcmFwcGVyIikucmVtb3ZlQXR0cmlidXRlKCJvcGVuIik7CiAgICB9CiAgICBkaXNwbGF5Wm9uZXMoZmlsdGVyZWRab25lcyk7Cn0KCmZ1bmN0aW9uIG9wZW5ab25lKGZpbGUpIHsKICAgIGlmIChmaWxlLnVybC5zdGFydHNXaXRoKCJodHRwIikpIHsKICAgICAgICB3aW5kb3cub3BlbihmaWxlLnVybCwgIl9ibGFuayIpOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB1cmwgPSBmaWxlLnVybC5yZXBsYWNlKCJ7Q09WRVJfVVJMfSIsIGNvdmVyVVJMKS5yZXBsYWNlKCJ7SFRNTF9VUkx9IiwgaHRtbFVSTCk7CiAgICAgICAgZmV0Y2godXJsKyI/dD0iK0RhdGUubm93KCkpLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UudGV4dCgpKS50aGVuKGh0bWwgPT4gewogICAgICAgICAgICBpZiAoem9uZUZyYW1lLmNvbnRlbnREb2N1bWVudCA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgem9uZUZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaWZyYW1lIik7CiAgICAgICAgICAgICAgICB6b25lRnJhbWUuaWQgPSAiem9uZUZyYW1lIjsKICAgICAgICAgICAgICAgIHpvbmVWaWV3ZXIuYXBwZW5kQ2hpbGQoem9uZUZyYW1lKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB6b25lRnJhbWUuY29udGVudERvY3VtZW50Lm9wZW4oKTsKICAgICAgICAgICAgem9uZUZyYW1lLmNvbnRlbnREb2N1bWVudC53cml0ZShodG1sKTsKICAgICAgICAgICAgem9uZUZyYW1lLmNvbnRlbnREb2N1bWVudC5jbG9zZSgpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9uZU5hbWUnKS50ZXh0Q29udGVudCA9IGZpbGUubmFtZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvbmVJZCcpLnRleHRDb250ZW50ID0gZmlsZS5pZDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvbmVBdXRob3InKS50ZXh0Q29udGVudCA9ICJieSAiICsgZmlsZS5hdXRob3I7CiAgICAgICAgICAgIGlmIChmaWxlLmF1dGhvckxpbmspIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b25lQXV0aG9yJykuaHJlZiA9IGZpbGUuYXV0aG9yTGluazsKICAgICAgICAgICAgfQogICAgICAgICAgICB6b25lVmlld2VyLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbik7CiAgICAgICAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KCdpZCcsIGZpbGUuaWQpOwogICAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCAnJywgdXJsLnRvU3RyaW5nKCkpOwogICAgICAgICAgICB6b25lVmlld2VyLmhpZGRlbiA9IHRydWU7CiAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gYWxlcnQoIkZhaWxlZCB0byBsb2FkIHpvbmU6ICIgKyBlcnJvcikpOwogICAgfQp9CgpmdW5jdGlvbiBhYm91dEJsYW5rKCkgewogICAgY29uc3QgbmV3V2luZG93ID0gd2luZG93Lm9wZW4oImFib3V0OmJsYW5rIiwgIl9ibGFuayIpOwogICAgbGV0IHpvbmUgPSB6b25lcy5maW5kKHpvbmUgPT4gem9uZS5pZCArICcnID09PSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9uZUlkJykudGV4dENvbnRlbnQpLnVybC5yZXBsYWNlKCJ7Q09WRVJfVVJMfSIsIGNvdmVyVVJMKS5yZXBsYWNlKCJ7SFRNTF9VUkx9IiwgaHRtbFVSTCk7CiAgICBmZXRjaCh6b25lKyI/dD0iK0RhdGUubm93KCkpLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UudGV4dCgpKS50aGVuKGh0bWwgPT4gewogICAgICAgIGlmIChuZXdXaW5kb3cpIHsKICAgICAgICAgICAgbmV3V2luZG93LmRvY3VtZW50Lm9wZW4oKTsKICAgICAgICAgICAgbmV3V2luZG93LmRvY3VtZW50LndyaXRlKGh0bWwpOwogICAgICAgICAgICBuZXdXaW5kb3cuZG9jdW1lbnQuY2xvc2UoKTsKICAgICAgICB9CiAgICB9KQp9CgpmdW5jdGlvbiBjbG9zZVpvbmUoKSB7CiAgICB6b25lVmlld2VyLmhpZGRlbiA9IGZhbHNlOwogICAgem9uZVZpZXdlci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgem9uZVZpZXdlci5yZW1vdmVDaGlsZCh6b25lRnJhbWUpOwogICAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24pOwogICAgdXJsLnNlYXJjaFBhcmFtcy5kZWxldGUoJ2lkJyk7CiAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCAnJywgdXJsLnRvU3RyaW5nKCkpOwp9CgpmdW5jdGlvbiBkb3dubG9hZFpvbmUoKSB7CiAgICBsZXQgem9uZSA9IHpvbmVzLmZpbmQoem9uZSA9PiB6b25lLmlkICsgJycgPT09IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6b25lSWQnKS50ZXh0Q29udGVudCk7CiAgICBmZXRjaCh6b25lLnVybC5yZXBsYWNlKCJ7SFRNTF9VUkx9IiwgaHRtbFVSTCkrIj90PSIrRGF0ZS5ub3coKSkudGhlbihyZXMgPT4gcmVzLnRleHQoKSkudGhlbih0ZXh0ID0+IHsKICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW3RleHRdLCB7CiAgICAgICAgICAgIHR5cGU6ICJ0ZXh0L3BsYWluO2NoYXJzZXQ9dXRmLTgiCiAgICAgICAgfSk7CiAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgIGEuaHJlZiA9IHVybDsKICAgICAgICBhLmRvd25sb2FkID0gem9uZS5uYW1lICsgIi5odG1sIjsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOwogICAgICAgIGEuY2xpY2soKTsKICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGEpOwogICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsKICAgIH0pOwp9CgpmdW5jdGlvbiBmdWxsc2NyZWVuWm9uZSgpIHsKICAgIGlmICh6b25lRnJhbWUucmVxdWVzdEZ1bGxzY3JlZW4pIHsKICAgICAgICB6b25lRnJhbWUucmVxdWVzdEZ1bGxzY3JlZW4oKTsKICAgIH0gZWxzZSBpZiAoem9uZUZyYW1lLm1velJlcXVlc3RGdWxsU2NyZWVuKSB7CiAgICAgICAgem9uZUZyYW1lLm1velJlcXVlc3RGdWxsU2NyZWVuKCk7CiAgICB9IGVsc2UgaWYgKHpvbmVGcmFtZS53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbikgewogICAgICAgIHpvbmVGcmFtZS53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbigpOwogICAgfSBlbHNlIGlmICh6b25lRnJhbWUubXNSZXF1ZXN0RnVsbHNjcmVlbikgewogICAgICAgIHpvbmVGcmFtZS5tc1JlcXVlc3RGdWxsc2NyZWVuKCk7CiAgICB9Cn0KCmZ1bmN0aW9uIHNhbml0aXplRGF0YShvYmosIG1heFN0cmluZ0xlbiA9IDEwMDAsIG1heEFycmF5TGVuID0gMTAwMDApIHsKICAgIGlmICh0eXBlb2Ygb2JqID09PSAnc3RyaW5nJykgewogICAgICByZXR1cm4gb2JqLmxlbmd0aCA+IG1heFN0cmluZ0xlbiA/IG9iai5zbGljZSgwLCBtYXhTdHJpbmdMZW4pICsgJy4uLlt0cnVuY2F0ZWRdJyA6IG9iajsKICAgIH0KICAgIAogICAgaWYgKG9iaiBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsKICAgICAgaWYgKG9iai5sZW5ndGggPiBtYXhBcnJheUxlbikgewogICAgICAgIHJldHVybiBgW1VpbnQ4QXJyYXkgdG9vIGxhcmdlICgke29iai5sZW5ndGh9IGJ5dGVzKSwgdHJ1bmNhdGVkXWA7CiAgICAgIH0KICAgICAgcmV0dXJuIG9iajsKICAgIH0KICAgIAogICAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkgewogICAgICByZXR1cm4gb2JqLm1hcChpdGVtID0+IHNhbml0aXplRGF0YShpdGVtLCBtYXhTdHJpbmdMZW4sIG1heEFycmF5TGVuKSk7CiAgICB9CiAgICAKICAgIGlmIChvYmogJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHsKICAgICAgY29uc3QgbmV3T2JqID0ge307CiAgICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikgewogICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgbmV3T2JqW2tleV0gPSBzYW5pdGl6ZURhdGEob2JqW2tleV0sIG1heFN0cmluZ0xlbiwgbWF4QXJyYXlMZW4pOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbmV3T2JqOwogICAgfQogICAgCiAgICByZXR1cm4gb2JqOwogIH0KCmFzeW5jIGZ1bmN0aW9uIHNhdmVEYXRhKCkgewogICAgYWxlcnQoIlRoaXMgbWlnaHQgdGFrZSBhIHdoaWxlLCBkb250IHRvdWNoIGFueXRoaW5nIG90aGVyIHRoYW4gdGhpcyBPSyBidXR0b24iKTsKICAgIGNvbnN0IHJlc3VsdCA9IHt9OwogICAgcmVzdWx0LmNvb2tpZXMgPSBkb2N1bWVudC5jb29raWU7CiAgICByZXN1bHQubG9jYWxTdG9yYWdlID0gey4uLmxvY2FsU3RvcmFnZX07CiAgICByZXN1bHQuc2Vzc2lvblN0b3JhZ2UgPSB7Li4uc2Vzc2lvblN0b3JhZ2V9OwogICAgcmVzdWx0LmluZGV4ZWREQiA9IHt9OwogICAgY29uc3QgZGJzID0gYXdhaXQgaW5kZXhlZERCLmRhdGFiYXNlcygpOwogICAgZm9yIChjb25zdCBkYkluZm8gb2YgZGJzKSB7CiAgICAgIGlmICghZGJJbmZvLm5hbWUpIGNvbnRpbnVlOwogICAgICByZXN1bHQuaW5kZXhlZERCW2RiSW5mby5uYW1lXSA9IHt9OwogICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgY29uc3Qgb3BlblJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYkluZm8ubmFtZSwgZGJJbmZvLnZlcnNpb24pOwogICAgICAgIG9wZW5SZXF1ZXN0Lm9uZXJyb3IgPSAoKSA9PiByZWplY3Qob3BlblJlcXVlc3QuZXJyb3IpOwogICAgICAgIG9wZW5SZXF1ZXN0Lm9uc3VjY2VzcyA9ICgpID0+IHsKICAgICAgICAgIGNvbnN0IGRiID0gb3BlblJlcXVlc3QucmVzdWx0OwogICAgICAgICAgY29uc3Qgc3RvcmVOYW1lcyA9IEFycmF5LmZyb20oZGIub2JqZWN0U3RvcmVOYW1lcyk7CiAgICAgICAgICBpZiAoc3RvcmVOYW1lcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGRiLnRyYW5zYWN0aW9uKHN0b3JlTmFtZXMsICJyZWFkb25seSIpOwogICAgICAgICAgY29uc3Qgc3RvcmVQcm9taXNlcyA9IFtdOwogICAgICAgICAgZm9yIChjb25zdCBzdG9yZU5hbWUgb2Ygc3RvcmVOYW1lcykgewogICAgICAgICAgICByZXN1bHQuaW5kZXhlZERCW2RiSW5mby5uYW1lXVtzdG9yZU5hbWVdID0gW107CiAgICAgICAgICAgIGNvbnN0IHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc3RvcmVOYW1lKTsKICAgICAgICAgICAgY29uc3QgZ2V0QWxsUmVxdWVzdCA9IHN0b3JlLmdldEFsbCgpOwogICAgICAgICAgICBjb25zdCBwID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7CiAgICAgICAgICAgICAgZ2V0QWxsUmVxdWVzdC5vbnN1Y2Nlc3MgPSAoKSA9PiB7CiAgICAgICAgICAgICAgICByZXN1bHQuaW5kZXhlZERCW2RiSW5mby5uYW1lXVtzdG9yZU5hbWVdID0gc2FuaXRpemVEYXRhKGdldEFsbFJlcXVlc3QucmVzdWx0LCAxMDAwLCAxMDApOwogICAgICAgICAgICAgICAgcmVzKCk7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBnZXRBbGxSZXF1ZXN0Lm9uZXJyb3IgPSAoKSA9PiByZWooZ2V0QWxsUmVxdWVzdC5lcnJvcik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBzdG9yZVByb21pc2VzLnB1c2gocCk7CiAgICAgICAgICB9CiAgICAgICAgICBQcm9taXNlLmFsbChzdG9yZVByb21pc2VzKS50aGVuKCgpID0+IHJlc29sdmUoKSk7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CgogICAgcmVzdWx0LmNhY2hlcyA9IHt9OwogICAgY29uc3QgY2FjaGVOYW1lcyA9IGF3YWl0IGNhY2hlcy5rZXlzKCk7CiAgICBmb3IgKGNvbnN0IGNhY2hlTmFtZSBvZiBjYWNoZU5hbWVzKSB7CiAgICAgIGNvbnN0IGNhY2hlID0gYXdhaXQgY2FjaGVzLm9wZW4oY2FjaGVOYW1lKTsKICAgICAgY29uc3QgcmVxdWVzdHMgPSBhd2FpdCBjYWNoZS5rZXlzKCk7CiAgICAgIHJlc3VsdC5jYWNoZXNbY2FjaGVOYW1lXSA9IFtdOwogICAgICBmb3IgKGNvbnN0IHJlcSBvZiByZXF1ZXN0cykgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FjaGUubWF0Y2gocmVxKTsKICAgICAgICBpZiAoIXJlc3BvbnNlKSBjb250aW51ZTsKICAgICAgICBjb25zdCBjbG9uZWQgPSByZXNwb25zZS5jbG9uZSgpOwogICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gY2xvbmVkLmhlYWRlcnMuZ2V0KCdjb250ZW50LXR5cGUnKSB8fCAnJzsKICAgICAgICBsZXQgYm9keTsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGNvbnRlbnRUeXBlLmluY2x1ZGVzKCdhcHBsaWNhdGlvbi9qc29uJykpIHsKICAgICAgICAgICAgYm9keSA9IGF3YWl0IGNsb25lZC5qc29uKCk7CiAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnRUeXBlLmluY2x1ZGVzKCd0ZXh0JykgfHwgY29udGVudFR5cGUuaW5jbHVkZXMoJ2phdmFzY3JpcHQnKSkgewogICAgICAgICAgICBib2R5ID0gYXdhaXQgY2xvbmVkLnRleHQoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGNsb25lZC5hcnJheUJ1ZmZlcigpOwogICAgICAgICAgICBib2R5ID0gYnRvYShTdHJpbmcuZnJvbUNoYXJDb2RlKC4uLm5ldyBVaW50OEFycmF5KGJ1ZmZlcikpKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICBib2R5ID0gJ1tVbmFibGUgdG8gcmVhZCBib2R5XSc7CiAgICAgICAgfQogICAgICAgIHJlc3VsdC5jYWNoZXNbY2FjaGVOYW1lXS5wdXNoKHsKICAgICAgICAgIHVybDogcmVxLnVybCwKICAgICAgICAgIGJvZHksCiAgICAgICAgICBjb250ZW50VHlwZQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgCiAgICBhbGVydCgiRG9uZSwgd2FpdCBmb3IgdGhlIGRvd25sb2FkIHRvIGNvbWUiKTsKICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKFtKU09OLnN0cmluZ2lmeShyZXN1bHQpXSwgewogICAgICAgIHR5cGU6ICJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iCiAgICB9KSk7CiAgICBsaW5rLmRvd25sb2FkID0gYCR7RGF0ZS5ub3coKX0uZGF0YWA7CiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOwogICAgbGluay5jbGljaygpOwogICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTsKICB9CiAgCiAgYXN5bmMgZnVuY3Rpb24gbG9hZERhdGEoZXZlbnQpIHsKICAgIGNvbnN0IGZpbGUgPSBldmVudC50YXJnZXQuZmlsZXNbMF07CiAgICBpZiAoIWZpbGUpIHJldHVybjsKICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICByZWFkZXIub25sb2FkID0gYXN5bmMgZnVuY3Rpb24gKGUpIHsKICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShlLnRhcmdldC5yZXN1bHQpOwogICAgICAgIGlmIChkYXRhLmNvb2tpZXMpIHsKICAgICAgICAgICAgZGF0YS5jb29raWVzLnNwbGl0KCc7JykuZm9yRWFjaChjb29raWUgPT4gewogICAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZS50cmltKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgaWYgKGRhdGEubG9jYWxTdG9yYWdlKSB7CiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGEubG9jYWxTdG9yYWdlKSB7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBkYXRhLmxvY2FsU3RvcmFnZVtrZXldKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgaWYgKGRhdGEuc2Vzc2lvblN0b3JhZ2UpIHsKICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gZGF0YS5zZXNzaW9uU3RvcmFnZSkgewogICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oa2V5LCBkYXRhLnNlc3Npb25TdG9yYWdlW2tleV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICBpZiAoZGF0YS5pbmRleGVkREIpIHsKICAgICAgICAgICAgZm9yIChjb25zdCBkYk5hbWUgaW4gZGF0YS5pbmRleGVkREIpIHsKICAgICAgICAgICAgICBjb25zdCBzdG9yZXMgPSBkYXRhLmluZGV4ZWREQltkYk5hbWVdOwogICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYk5hbWUsIDEpOwogICAgICAgICAgICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBlID0+IHsKICAgICAgICAgICAgICAgICAgY29uc3QgZGIgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc3RvcmVOYW1lIGluIHN0b3JlcykgewogICAgICAgICAgICAgICAgICAgIGlmICghZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhzdG9yZU5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShzdG9yZU5hbWUsIHsga2V5UGF0aDogJ2lkJywgYXV0b0luY3JlbWVudDogdHJ1ZSB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGUgPT4gewogICAgICAgICAgICAgICAgICBjb25zdCBkYiA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbihPYmplY3Qua2V5cyhzdG9yZXMpLCAncmVhZHdyaXRlJyk7CiAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLm9uZXJyb3IgPSAoKSA9PiByZWplY3QodHJhbnNhY3Rpb24uZXJyb3IpOwogICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1N0b3JlcyA9IE9iamVjdC5rZXlzKHN0b3JlcykubGVuZ3RoOwogICAgICAgIAogICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHN0b3JlTmFtZSBpbiBzdG9yZXMpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7CiAgICAgICAgICAgICAgICAgICAgb2JqZWN0U3RvcmUuY2xlYXIoKS5vbnN1Y2Nlc3MgPSAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2Ygc3RvcmVzW3N0b3JlTmFtZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0U3RvcmUucHV0KGl0ZW0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1N0b3Jlcy0tOwogICAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdTdG9yZXMgPT09IDApIHJlc29sdmUoKTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gKCkgPT4gcmVqZWN0KHJlcXVlc3QuZXJyb3IpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICBpZiAoZGF0YS5jYWNoZXMpIHsKICAgICAgICAgICAgZm9yIChjb25zdCBjYWNoZU5hbWUgaW4gZGF0YS5jYWNoZXMpIHsKICAgICAgICAgICAgICBjb25zdCBjYWNoZSA9IGF3YWl0IGNhY2hlcy5vcGVuKGNhY2hlTmFtZSk7CiAgICAgICAgICAgICAgYXdhaXQgY2FjaGUua2V5cygpLnRoZW4oa2V5cyA9PiBQcm9taXNlLmFsbChrZXlzLm1hcChrID0+IGNhY2hlLmRlbGV0ZShrKSkpKTsgLy8gY2xlYXIgZXhpc3RpbmcKICAgICAgICAKICAgICAgICAgICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGRhdGEuY2FjaGVzW2NhY2hlTmFtZV0pIHsKICAgICAgICAgICAgICAgIGxldCByZXNwb25zZUJvZHk7CiAgICAgICAgICAgICAgICBpZiAoZW50cnkuY29udGVudFR5cGUuaW5jbHVkZXMoJ2FwcGxpY2F0aW9uL2pzb24nKSkgewogICAgICAgICAgICAgICAgICByZXNwb25zZUJvZHkgPSBKU09OLnN0cmluZ2lmeShlbnRyeS5ib2R5KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZW50cnkuY29udGVudFR5cGUuaW5jbHVkZXMoJ3RleHQnKSB8fCBlbnRyeS5jb250ZW50VHlwZS5pbmNsdWRlcygnamF2YXNjcmlwdCcpKSB7CiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlQm9keSA9IGVudHJ5LmJvZHk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBjb25zdCBiaW5hcnlTdHIgPSBhdG9iKGVudHJ5LmJvZHkpOwogICAgICAgICAgICAgICAgICBjb25zdCBsZW4gPSBiaW5hcnlTdHIubGVuZ3RoOwogICAgICAgICAgICAgICAgICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGxlbik7CiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBieXRlc1tpXSA9IGJpbmFyeVN0ci5jaGFyQ29kZUF0KGkpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlQm9keSA9IGJ5dGVzLmJ1ZmZlcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSGVhZGVycyh7ICdjb250ZW50LXR5cGUnOiBlbnRyeS5jb250ZW50VHlwZSB9KTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gbmV3IFJlc3BvbnNlKHJlc3BvbnNlQm9keSwgeyBoZWFkZXJzIH0pOwogICAgICAgICAgICAgICAgYXdhaXQgY2FjaGUucHV0KGVudHJ5LnVybCwgcmVzcG9uc2UpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIGFsZXJ0KCJEYXRhIGxvYWRlZCIpOwogICAgfTsKICAgIGFsZXJ0KCJUaGlzIG1pZ2h0IHRha2UgYSB3aGlsZSwgZG9udCB0b3VjaCBhbnl0aGluZyBvdGhlciB0aGFuIHRoaXMgT0sgYnV0dG9uIik7CiAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTsKICB9CgpmdW5jdGlvbiBkYXJrTW9kZSgpIHsKICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgiZGFyay1tb2RlIik7Cn0KCmZ1bmN0aW9uIGNsb2FrSWNvbih1cmwpIHsKICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJsaW5rW3JlbH49J2ljb24nXSIpOwogICAgbGluay5yZWwgPSAiaWNvbiI7CiAgICBpZiAoKHVybCsiIikudHJpbSgpLmxlbmd0aCA9PT0gMCkgewogICAgICAgIGxpbmsuaHJlZiA9ICJmYXZpY29uLnBuZyI7CiAgICB9IGVsc2UgewogICAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgIH0KICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQobGluayk7Cn0KZnVuY3Rpb24gY2xvYWtOYW1lKHN0cmluZykgewogICAgaWYgKChzdHJpbmcrIiIpLnRyaW0oKS5sZW5ndGggPT09IDApIHsKICAgICAgICBkb2N1bWVudC50aXRsZSA9ICJnbi1tYXRoIjsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBkb2N1bWVudC50aXRsZSA9IHN0cmluZzsKfQoKZnVuY3Rpb24gdGFiQ2xvYWsoKSB7CiAgICBjbG9zZVBvcHVwKCk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBUaXRsZScpLnRleHRDb250ZW50ID0gIlRhYiBDbG9hayI7CiAgICBjb25zdCBwb3B1cEJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBCb2R5Jyk7CiAgICBwb3B1cEJvZHkuaW5uZXJIVE1MID0gYAogICAgICAgIDxsYWJlbCBmb3I9InRhYi1jbG9hay10ZXh0Ym94IiBzdHlsZT0iZm9udC13ZWlnaHQ6IGJvbGQ7Ij5TZXQgVGFiIFRpdGxlOjwvbGFiZWw+PGJyPgogICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0idGFiLWNsb2FrLXRleHRib3giIHBsYWNlaG9sZGVyPSJFbnRlciBuZXcgdGFiIG5hbWUuLi4iIG9uaW5wdXQ9ImNsb2FrTmFtZSh0aGlzLnZhbHVlKSI+CiAgICAgICAgPGJyPjxicj48YnI+PGJyPgogICAgICAgIDxsYWJlbCBmb3I9InRhYi1jbG9hay10ZXh0Ym94IiBzdHlsZT0iZm9udC13ZWlnaHQ6IGJvbGQ7Ij5TZXQgVGFiIEljb246PC9sYWJlbD48YnI+CiAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJ0YWItY2xvYWstdGV4dGJveCIgcGxhY2Vob2xkZXI9IkVudGVyIG5ldyB0YWIgaWNvbi4uLiIgb25pbnB1dD0nY2xvYWtJY29uKHRoaXMudmFsdWUpJz4KICAgICAgICA8YnI+PGJyPjxicj4KICAgIGA7CiAgICBwb3B1cEJvZHkuY29udGVudEVkaXRhYmxlID0gZmFsc2U7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKfQoKY29uc3Qgc2V0dGluZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dGluZ3MnKTsKc2V0dGluZ3MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBUaXRsZScpLnRleHRDb250ZW50ID0gIlNldHRpbmdzIjsKICAgIGNvbnN0IHBvcHVwQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cEJvZHknKTsKICAgIHBvcHVwQm9keS5pbm5lckhUTUwgPSBgCiAgICA8YnV0dG9uIGNsYXNzPSJzZXR0aW5ncy1idXR0b24iIG9uY2xpY2s9ImRhcmtNb2RlKCkiPlRvZ2dsZSBEYXJrIE1vZGU8L2J1dHRvbj4KICAgIDxicj48YnI+CiAgICA8YnV0dG9uIGNsYXNzPSJzZXR0aW5ncy1idXR0b24iIG9uY2xpY2s9InRhYkNsb2FrKCkiPlRhYiBDbG9hazwvYnV0dG9uPgogICAgPGJyPgogICAgYDsKICAgIHBvcHVwQm9keS5jb250ZW50RWRpdGFibGUgPSBmYWxzZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cE92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwp9KTsKCmZ1bmN0aW9uIHNob3dDb250YWN0KCkgewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwVGl0bGUnKS50ZXh0Q29udGVudCA9ICJDb250YWN0IjsKICAgIGNvbnN0IHBvcHVwQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cEJvZHknKTsKICAgIHBvcHVwQm9keS5pbm5lckhUTUwgPSBgCiAgICA8cD5EaXNjb3JkOiBodHRwczovL2Rpc2NvcmQuZ2cvTkFGdzR5a1o3bjwvcD4KICAgIDxwPkVtYWlsOiBnbi5tYXRoLmJ1c2luZXNzQGdtYWlsLmNvbTwvcD5gOwogICAgcG9wdXBCb2R5LmNvbnRlbnRFZGl0YWJsZSA9IGZhbHNlOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwT3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7Cn0KCmZ1bmN0aW9uIGxvYWRQcml2YWN5KCkgewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwVGl0bGUnKS50ZXh0Q29udGVudCA9ICJQcml2YWN5IFBvbGljeSI7CiAgICBjb25zdCBwb3B1cEJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBCb2R5Jyk7CiAgICBwb3B1cEJvZHkuaW5uZXJIVE1MID0gYAogICAgICAgIDxkaXYgc3R5bGU9Im1heC1oZWlnaHQ6IDYwdmg7IG92ZXJmbG93LXk6IGF1dG87Ij4KICAgICAgICAgICAgPGgyPlBSSVZBQ1kgUE9MSUNZPC9oMj4KICAgICAgICAgICAgPHA+TGFzdCB1cGRhdGVkIEFwcmlsIDE3LCAyMDI1PC9wPgogICAgICAgICAgICA8cD5UaGlzIFByaXZhY3kgTm90aWNlIGZvciBnbi1tYXRoICgid2UsIiAidXMsIiBvciAib3VyIiksIGRlc2NyaWJlcyBob3cgYW5kIHdoeSB3ZSBtaWdodCBhY2Nlc3MsIGNvbGxlY3QsIHN0b3JlLCB1c2UsIGFuZC9vciBzaGFyZSAoInByb2Nlc3MiKSB5b3VyIHBlcnNvbmFsIGluZm9ybWF0aW9uIHdoZW4geW91IHVzZSBvdXIgc2VydmljZXMgKCJTZXJ2aWNlcyIpLCBpbmNsdWRpbmcgd2hlbiB5b3U6PC9wPgogICAgICAgICAgICA8dWw+CiAgICAgICAgICAgICAgICA8bGk+VmlzaXQgb3VyIHdlYnNpdGUgYXQgPGEgaHJlZj0iaHR0cHM6Ly9nbi1tYXRoLmdpdGh1Yi5pbyI+aHR0cHM6Ly9nbi1tYXRoLmdpdGh1Yi5pbzwvYT4sIG9yIGFueSB3ZWJzaXRlIG9mIG91cnMgdGhhdCBsaW5rcyB0byB0aGlzIFByaXZhY3kgTm90aWNlPC9saT4KICAgICAgICAgICAgICAgIDxsaT5FbmdhZ2Ugd2l0aCB1cyBpbiBvdGhlciByZWxhdGVkIHdheXMsIGluY2x1ZGluZyBhbnkgc2FsZXMsIG1hcmtldGluZywgb3IgZXZlbnRzPC9saT4KICAgICAgICAgICAgPC91bD4KICAgICAgICAgICAgPHA+UXVlc3Rpb25zIG9yIGNvbmNlcm5zPyBSZWFkaW5nIHRoaXMgUHJpdmFjeSBOb3RpY2Ugd2lsbCBoZWxwIHlvdSB1bmRlcnN0YW5kIHlvdXIgcHJpdmFjeSByaWdodHMgYW5kIGNob2ljZXMuIFdlIGFyZSByZXNwb25zaWJsZSBmb3IgbWFraW5nIGRlY2lzaW9ucyBhYm91dCBob3cgeW91ciBwZXJzb25hbCBpbmZvcm1hdGlvbiBpcyBwcm9jZXNzZWQuIElmIHlvdSBkbyBub3QgYWdyZWUgd2l0aCBvdXIgcG9saWNpZXMgYW5kIHByYWN0aWNlcywgcGxlYXNlIGRvIG5vdCB1c2Ugb3VyIFNlcnZpY2VzLiBJZiB5b3Ugc3RpbGwgaGF2ZSBhbnkgcXVlc3Rpb25zIG9yIGNvbmNlcm5zLCBwbGVhc2UgY29udGFjdCB1cyBhdCA8YSBocmVmPSJodHRwczovL2Rpc2NvcmQuZ2cvTkFGdzR5a1o3biI+aHR0cHM6Ly9kaXNjb3JkLmdnL05BRnc0eWtaN248L2E+LjwvcD4KICAgICAgICAgICAgCiAgICAgICAgICAgIDxoMz5TVU1NQVJZIE9GIEtFWSBQT0lOVFM8L2gzPgogICAgICAgICAgICA8cD5UaGlzIHN1bW1hcnkgcHJvdmlkZXMga2V5IHBvaW50cyBmcm9tIG91ciBQcml2YWN5IE5vdGljZSwgYnV0IHlvdSBjYW4gZmluZCBvdXQgbW9yZSBkZXRhaWxzIGFib3V0IGFueSBvZiB0aGVzZSB0b3BpY3MgYnkgY2xpY2tpbmcgdGhlIGxpbmsgZm9sbG93aW5nIGVhY2gga2V5IHBvaW50IG9yIGJ5IHVzaW5nIG91ciB0YWJsZSBvZiBjb250ZW50cyBiZWxvdyB0byBmaW5kIHRoZSBzZWN0aW9uIHlvdSBhcmUgbG9va2luZyBmb3IuPC9wPgogICAgICAgICAgICAKICAgICAgICAgICAgPHA+PHN0cm9uZz5XaGF0IHBlcnNvbmFsIGluZm9ybWF0aW9uIGRvIHdlIHByb2Nlc3M/PC9zdHJvbmc+IFdoZW4geW91IHZpc2l0LCB1c2UsIG9yIG5hdmlnYXRlIG91ciBTZXJ2aWNlcywgd2UgbWF5IHByb2Nlc3MgcGVyc29uYWwgaW5mb3JtYXRpb24gZGVwZW5kaW5nIG9uIGhvdyB5b3UgaW50ZXJhY3Qgd2l0aCB1cyBhbmQgdGhlIFNlcnZpY2VzLCB0aGUgY2hvaWNlcyB5b3UgbWFrZSwgYW5kIHRoZSBwcm9kdWN0cyBhbmQgZmVhdHVyZXMgeW91IHVzZS4gTGVhcm4gbW9yZSBhYm91dCBwZXJzb25hbCBpbmZvcm1hdGlvbiB5b3UgZGlzY2xvc2UgdG8gdXMuPC9wPgogICAgICAgICAgICAKICAgICAgICAgICAgPHA+PHN0cm9uZz5EbyB3ZSBwcm9jZXNzIGFueSBzZW5zaXRpdmUgcGVyc29uYWwgaW5mb3JtYXRpb24/PC9zdHJvbmc+IFNvbWUgb2YgdGhlIGluZm9ybWF0aW9uIG1heSBiZSBjb25zaWRlcmVkICJzcGVjaWFsIiBvciAic2Vuc2l0aXZlIiBpbiBjZXJ0YWluIGp1cmlzZGljdGlvbnMsIGZvciBleGFtcGxlIHlvdXIgcmFjaWFsIG9yIGV0aG5pYyBvcmlnaW5zLCBzZXh1YWwgb3JpZW50YXRpb24sIGFuZCByZWxpZ2lvdXMgYmVsaWVmcy4gV2UgZG8gbm90IHByb2Nlc3Mgc2Vuc2l0aXZlIHBlcnNvbmFsIGluZm9ybWF0aW9uLjwvcD4KICAgICAgICAgICAgCiAgICAgICAgICAgIDxwPjxzdHJvbmc+RG8gd2UgY29sbGVjdCBhbnkgaW5mb3JtYXRpb24gZnJvbSB0aGlyZCBwYXJ0aWVzPzwvc3Ryb25nPiBXZSBkbyBub3QgY29sbGVjdCBhbnkgaW5mb3JtYXRpb24gZnJvbSB0aGlyZCBwYXJ0aWVzLjwvcD4KICAgICAgICAgICAgCiAgICAgICAgICAgIDxwPjxzdHJvbmc+SG93IGRvIHdlIHByb2Nlc3MgeW91ciBpbmZvcm1hdGlvbj88L3N0cm9uZz4gV2UgcHJvY2VzcyB5b3VyIGluZm9ybWF0aW9uIHRvIHByb3ZpZGUsIGltcHJvdmUsIGFuZCBhZG1pbmlzdGVyIG91ciBTZXJ2aWNlcywgY29tbXVuaWNhdGUgd2l0aCB5b3UsIGZvciBzZWN1cml0eSBhbmQgZnJhdWQgcHJldmVudGlvbiwgYW5kIHRvIGNvbXBseSB3aXRoIGxhdy4gV2UgbWF5IGFsc28gcHJvY2VzcyB5b3VyIGluZm9ybWF0aW9uIGZvciBvdGhlciBwdXJwb3NlcyB3aXRoIHlvdXIgY29uc2VudC4gV2UgcHJvY2VzcyB5b3VyIGluZm9ybWF0aW9uIG9ubHkgd2hlbiB3ZSBoYXZlIGEgdmFsaWQgbGVnYWwgcmVhc29uIHRvIGRvIHNvLiBMZWFybiBtb3JlIGFib3V0IGhvdyB3ZSBwcm9jZXNzIHlvdXIgaW5mb3JtYXRpb24uPC9wPgogICAgICAgICAgICAKICAgICAgICAgICAgPHA+PHN0cm9uZz5JbiB3aGF0IHNpdHVhdGlvbnMgYW5kIHdpdGggd2hpY2ggcGFydGllcyBkbyB3ZSBzaGFyZSBwZXJzb25hbCBpbmZvcm1hdGlvbj88L3N0cm9uZz4gV2UgbWF5IHNoYXJlIGluZm9ybWF0aW9uIGluIHNwZWNpZmljIHNpdHVhdGlvbnMgYW5kIHdpdGggc3BlY2lmaWMgdGhpcmQgcGFydGllcy4gTGVhcm4gbW9yZSBhYm91dCB3aGVuIGFuZCB3aXRoIHdob20gd2Ugc2hhcmUgeW91ciBwZXJzb25hbCBpbmZvcm1hdGlvbi48L3A+CiAgICAgICAgICAgIAogICAgICAgICAgICA8cD48c3Ryb25nPkhvdyBkbyB3ZSBrZWVwIHlvdXIgaW5mb3JtYXRpb24gc2FmZT88L3N0cm9uZz4gV2UgaGF2ZSBhZGVxdWF0ZSBvcmdhbml6YXRpb25hbCBhbmQgdGVjaG5pY2FsIHByb2Nlc3NlcyBhbmQgcHJvY2VkdXJlcyBpbiBwbGFjZSB0byBwcm90ZWN0IHlvdXIgcGVyc29uYWwgaW5mb3JtYXRpb24uIEhvd2V2ZXIsIG5vIGVsZWN0cm9uaWMgdHJhbnNtaXNzaW9uIG92ZXIgdGhlIGludGVybmV0IG9yIGluZm9ybWF0aW9uIHN0b3JhZ2UgdGVjaG5vbG9neSBjYW4gYmUgZ3VhcmFudGVlZCB0byBiZSAxMDAlIHNlY3VyZSwgc28gd2UgY2Fubm90IHByb21pc2Ugb3IgZ3VhcmFudGVlIHRoYXQgaGFja2VycywgY3liZXJjcmltaW5hbHMsIG9yIG90aGVyIHVuYXV0aG9yaXplZCB0aGlyZCBwYXJ0aWVzIHdpbGwgbm90IGJlIGFibGUgdG8gZGVmZWF0IG91ciBzZWN1cml0eSBhbmQgaW1wcm9wZXJseSBjb2xsZWN0LCBhY2Nlc3MsIHN0ZWFsLCBvciBtb2RpZnkgeW91ciBpbmZvcm1hdGlvbi4gTGVhcm4gbW9yZSBhYm91dCBob3cgd2Uga2VlcCB5b3VyIGluZm9ybWF0aW9uIHNhZmUuPC9wPgogICAgICAgICAgICAKICAgICAgICAgICAgPHA+PHN0cm9uZz5XaGF0IGFyZSB5b3VyIHJpZ2h0cz88L3N0cm9uZz4gRGVwZW5kaW5nIG9uIHdoZXJlIHlvdSBhcmUgbG9jYXRlZCBnZW9ncmFwaGljYWxseSwgdGhlIGFwcGxpY2FibGUgcHJpdmFjeSBsYXcgbWF5IG1lYW4geW91IGhhdmUgY2VydGFpbiByaWdodHMgcmVnYXJkaW5nIHlvdXIgcGVyc29uYWwgaW5mb3JtYXRpb24uIExlYXJuIG1vcmUgYWJvdXQgeW91ciBwcml2YWN5IHJpZ2h0cy48L3A+CiAgICAgICAgICAgIAogICAgICAgICAgICA8cD48c3Ryb25nPkhvdyBkbyB5b3UgZXhlcmNpc2UgeW91ciByaWdodHM/PC9zdHJvbmc+IFRoZSBlYXNpZXN0IHdheSB0byBleGVyY2lzZSB5b3VyIHJpZ2h0cyBpcyBieSBzdWJtaXR0aW5nIGEgZGF0YSBzdWJqZWN0IGFjY2VzcyByZXF1ZXN0LCBvciBieSBjb250YWN0aW5nIHVzLiBXZSB3aWxsIGNvbnNpZGVyIGFuZCBhY3QgdXBvbiBhbnkgcmVxdWVzdCBpbiBhY2NvcmRhbmNlIHdpdGggYXBwbGljYWJsZSBkYXRhIHByb3RlY3Rpb24gbGF3cy48L3A+CiAgICAgICAgPC9kaXY+CiAgICBgOwogICAgcG9wdXBCb2R5LmNvbnRlbnRFZGl0YWJsZSA9IGZhbHNlOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwT3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7Cn0KCmZ1bmN0aW9uIGxvYWRETUNBKCkgewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwVGl0bGUnKS50ZXh0Q29udGVudCA9ICJETUNBIjsKICAgIGNvbnN0IHBvcHVwQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cEJvZHknKTsKICAgIHBvcHVwQm9keS5pbm5lckhUTUwgPSBgCiAgICAgICAgPGRpdiBjbGFzcz0iZG1jYS1jb250ZW50Ij4KICAgICAgICAgICAgPHA+CiAgICAgICAgICAgICAgICBJZiB5b3Ugb3duIG9yIGRldmVsb3BlZCBhIGdhbWUgdGhhdCBpcyBvbiA8c3Ryb25nPmduLW1hdGg8L3N0cm9uZz4gCiAgICAgICAgICAgICAgICBhbmQgd291bGQgbGlrZSBpdCByZW1vdmVkLCBwbGVhc2UgZG8gb25lIG9mIHRoZSBmb2xsb3dpbmc6CiAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgPG9sPgogICAgICAgICAgICAgICAgPGxpPgogICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9Imh0dHBzOi8vZGlzY29yZC5nZy9ENGM5VkZZV3lVIiB0YXJnZXQ9Il9ibGFuayIgcmVsPSJub29wZW5lciBub3JlZmVycmVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgSm9pbiB0aGUgRGlzY29yZAogICAgICAgICAgICAgICAgICAgIDwvYT4gYW5kIERNIDxzdHJvbmc+YnJlYWRiYjwvc3Ryb25nPiBvciBwaW5nIG1lIGluIGEgcHVibGljIGNoYW5uZWwgCiAgICAgICAgICAgICAgICAgICAgPHN0cm9uZz5bSU5TVEFOVCBSRVNQT05TRV08L3N0cm9uZz4KICAgICAgICAgICAgICAgIDwvbGk+CiAgICAgICAgICAgICAgICA8bGk+CiAgICAgICAgICAgICAgICAgICAgRW1haWwgbWUgYXQgCiAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0ibWFpbHRvOmduLm1hdGguYnVzaW5lc3NAZ21haWwuY29tIj5nbi5tYXRoLmJ1c2luZXNzQGdtYWlsLmNvbTwvYT4gCiAgICAgICAgICAgICAgICAgICAgd2l0aCB0aGUgc3ViamVjdCBzdGFydGluZyB3aXRoIDxjb2RlPiFETUNBPC9jb2RlPi4KICAgICAgICAgICAgICAgICAgICA8c3Ryb25nPltERUxBWUVEIFJFU1BPTlNFXTwvc3Ryb25nPgogICAgICAgICAgICAgICAgPC9saT4KICAgICAgICAgICAgPC9vbD4KICAgICAgICAgICAgPHA+CiAgICAgICAgICAgICAgICBJZiB5b3UgYXJlIGdvaW5nIHRvIGRvIGFuIGVtYWlsLCBwbGVhc2Ugc2hvdyBwcm9vZiB5b3Ugb3duIHRoZSBnYW1lIGJlZm9yZSBJIGhhdmUgdG8gYXNrLgogICAgICAgICAgICA8L3A+CiAgICAgICAgPC9kaXY+CiAgICBgOwogICAgcG9wdXBCb2R5LmNvbnRlbnRFZGl0YWJsZSA9IGZhbHNlOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwT3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7Cn0KCgpsZXQgX2FsbFN0YXRzQ2FjaGUgPSBudWxsOwoKYXN5bmMgZnVuY3Rpb24gZ2V0QWxsU3RhdHMoKSB7CiAgaWYgKF9hbGxTdGF0c0NhY2hlKSB7CiAgICByZXR1cm4gX2FsbFN0YXRzQ2FjaGU7CiAgfQoKICBjb25zdCBCQVNFX1VSTCA9CiAgICAiaHR0cHM6Ly9kYXRhLmpzZGVsaXZyLmNvbS92MS9zdGF0cy9wYWNrYWdlcy9naC9nbi1tYXRoL2h0bWxAbWFpbi9maWxlcyI7CiAgY29uc3QgUEVSSU9EID0gInllYXIiOwogIGNvbnN0IFBBR0VfQkFUQ0ggPSA1OwoKICBsZXQgcGFnZSA9IDE7CiAgbGV0IGRvbmUgPSBmYWxzZTsKICBjb25zdCBjb21iaW5lZE1hcCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogIHdoaWxlICghZG9uZSkgewogICAgY29uc3QgcGFnZXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBQQUdFX0JBVENIIH0sIChfLCBpKSA9PiBwYWdlICsgaSk7CgogICAgY29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwoCiAgICAgIHBhZ2VzLm1hcChwID0+CiAgICAgICAgZmV0Y2goYCR7QkFTRV9VUkx9P3BlcmlvZD0ke1BFUklPRH0mcGFnZT0ke3B9JmxpbWl0PTEwMGApCiAgICAgICAgICAudGhlbihyID0+IChyLm9rID8gci5qc29uKCkgOiBbXSkpCiAgICAgICkKICAgICk7CgogICAgZm9yIChjb25zdCBkYXRhIG9mIHJlc3BvbnNlcykgewogICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZGF0YSkgfHwgZGF0YS5sZW5ndGggPT09IDApIHsKICAgICAgICBkb25lID0gdHJ1ZTsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGRhdGEpIHsKICAgICAgICBpZiAoIWl0ZW0/Lm5hbWUpIGNvbnRpbnVlOwoKICAgICAgICBjb25zdCBtYXRjaCA9IGl0ZW0ubmFtZS5tYXRjaCgvXlwvKFxkKykoWy4tXSkvKTsKICAgICAgICBpZiAoIW1hdGNoKSBjb250aW51ZTsKCiAgICAgICAgY29uc3QgaWQgPSBtYXRjaFsxXTsKCiAgICAgICAgaWYgKCFjb21iaW5lZE1hcFtpZF0pIHsKICAgICAgICAgIGNvbWJpbmVkTWFwW2lkXSA9IHsKICAgICAgICAgICAgaGl0czogMCwKICAgICAgICAgICAgYmFuZHdpZHRoOiAwCiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgY29tYmluZWRNYXBbaWRdLmhpdHMgKz0gaXRlbS5oaXRzPy50b3RhbCA/PyAwOwogICAgICAgIGNvbWJpbmVkTWFwW2lkXS5iYW5kd2lkdGggKz0gaXRlbS5iYW5kd2lkdGg/LnRvdGFsID8/IDA7CiAgICAgIH0KICAgIH0KCiAgICBwYWdlICs9IFBBR0VfQkFUQ0g7CiAgfQoKICBfYWxsU3RhdHNDYWNoZSA9IGNvbWJpbmVkTWFwOwogIHJldHVybiBjb21iaW5lZE1hcDsKfQoKYXN5bmMgZnVuY3Rpb24gZ2V0U3RhdHMoaWQpIHsKICBpZCA9IFN0cmluZyhpZCk7CiAgY29uc3QgYWxsU3RhdHMgPSBhd2FpdCBnZXRBbGxTdGF0cygpOwoKICByZXR1cm4gYWxsU3RhdHNbaWRdPy5oaXRzID8/IDA7Cn0KCmZ1bmN0aW9uIHNob3dab25lSW5mbygpIHsKICAgIGxldCBpZCA9IE51bWJlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9uZUlkJykudGV4dENvbnRlbnQpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwVGl0bGUnKS50ZXh0Q29udGVudCA9ICJJbmZvIjsKICAgIGNvbnN0IHBvcHVwQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cEJvZHknKTsKICAgIHBvcHVwQm9keS5pbm5lckhUTUwgPSBgPHA+TG9hZGluZy4uLjwvcD5gCiAgICBwb3B1cEJvZHkuY29udGVudEVkaXRhYmxlID0gZmFsc2U7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgIGZldGNoKGBodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL2duLW1hdGgvaHRtbC9jb21taXRzP3BhdGg9JHtpZH0uaHRtbGApLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpLnRoZW4oYXN5bmMganNvbiA9PiB7CiAgICAgICAgbGV0IHN0YXRzID0gYXdhaXQgZ2V0U3RhdHMgKGlkKTsKICAgICAgICBpZGpzb24gPSB6b25lcy5maWx0ZXIoYT0+YS5pZD09PWlkKVswXQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cFRpdGxlJykudGV4dENvbnRlbnQgPSBgJHtpZGpzb24ubmFtZX0gSW5mb2A7CiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGpzb24uYXQoLTEpLmNvbW1pdC5hdXRob3IuZGF0ZSk7CiAgICAgICAgbGV0IGZvcm1hdHRlZGRhdGUgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdCgiZW4tVVMiLCB7CiAgbW9udGg6ICJsb25nIiwKICBkYXk6ICJudW1lcmljIiwKICB5ZWFyOiAibnVtZXJpYyIsCiAgaG91cjogIm51bWVyaWMiLAogIG1pbnV0ZTogIjItZGlnaXQiLAogIGhvdXIxMjogdHJ1ZQp9KS5mb3JtYXQoZGF0ZSk7CiAgICAgICAgcG9wdXBCb2R5LmlubmVySFRNTCA9IGAKICAgICAgICA8cD4KICAgICAgICA8Yj5JZDwvYj46ICR7aWR9PGJyPgogICAgICAgIDxiPk5hbWU8L2I+OiAke2lkanNvbi5uYW1lfTxicj4KICAgICAgICAke2lkanNvbi5hdXRob3I/YDxiPkdhbWUgQXV0aG9yPC9iPjogJHtpZGpzb24uYXV0aG9yfTxicj5gOiIifQogICAgICAgICR7aWRqc29uLmF1dGhvckxpbms/YDxiPkdhbWUgQXV0aG9yIExpbms8L2I+OiA8YSBzdHlsZT0iY29sb3I6I0ZGRkYwMDsiIGhyZWY9JHtpZGpzb24uYXV0aG9yTGlua30+JHtpZGpzb24uYXV0aG9yTGlua308L2E+PGJyPmA6IiJ9CiAgICAgICAgJHtpZGpzb24uc3BlY2lhbD9gPGI+VGFnczwvYj46ICR7aWRqc29uLnNwZWNpYWx9PGJyPmA6IiJ9CiAgICAgICAgPGI+R24tTWF0aCBBZGRlcjwvYj46ICR7anNvbi5hdCgtMSkuY29tbWl0LmF1dGhvci5uYW1lfTxicj4KICAgICAgICA8Yj5EYXRlIEFkZGVkPC9iPjogJHtmb3JtYXR0ZWRkYXRlfTxicj4KICAgICAgICA8Yj5UaW1lcyBQbGF5ZWQgKEdsb2JhbGx5KTwvYj46ICR7TnVtYmVyKHN0YXRzKS50b0xvY2FsZVN0cmluZygiZW4tVVMiKX0KICAgICAgICA8L3A+YDsKICAgIH0pCn0KCmZ1bmN0aW9uIGNsb3NlUG9wdXAoKSB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKfQpsaXN0Wm9uZXMoKTsKCmNvbnN0IHNjaG9vbExpc3QgPSBbImRlbGVkYW8iLCAiZ29ndWFyZGlhbiIsICJsaWdodHNwZWVkIiwgImxpbmV3aXplIiwgInNlY3VybHkiLCAiLmVkdS8iXTsKCmZ1bmN0aW9uIGlzQmxvY2tlZERvbWFpbih1cmwpIHsKICAgIGNvbnN0IGRvbWFpbiA9IG5ldyBVUkwodXJsLCBsb2NhdGlvbi5vcmlnaW4pLmhvc3RuYW1lICsgIi8iOwogICAgcmV0dXJuIHNjaG9vbExpc3Quc29tZShzY2hvb2wgPT4gZG9tYWluLmluY2x1ZGVzKHNjaG9vbCkpOwp9Cgpjb25zdCBvcmlnaW5hbEZldGNoID0gd2luZG93LmZldGNoOwp3aW5kb3cuZmV0Y2ggPSBmdW5jdGlvbiAodXJsLCBvcHRpb25zKSB7CiAgICBpZiAoaXNCbG9ja2VkRG9tYWluKHVybCkpIHsKICAgICAgICBjb25zb2xlLndhcm4oYGxhbWApOwogICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoImxhbSIpKTsKICAgIH0KICAgIHJldHVybiBvcmlnaW5hbEZldGNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn07Cgpjb25zdCBvcmlnaW5hbE9wZW4gPSBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub3BlbjsKWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiAobWV0aG9kLCB1cmwpIHsKICAgIGlmIChpc0Jsb2NrZWREb21haW4odXJsKSkgewogICAgICAgIGNvbnNvbGUud2FybihgbGFtYCk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgcmV0dXJuIG9yaWdpbmFsT3Blbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9OwoKSFRNTENhbnZhc0VsZW1lbnQucHJvdG90eXBlLnRvRGF0YVVSTCA9IGZ1bmN0aW9uICguLi5hcmdzKSB7CiAgICByZXR1cm4gIiI7Cn07PC9zY3JpcHQ+CiAgICA8c2NyaXB0PgogICAgICAgIGNvbnN0IHNlYXJjaCA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7CiAgICAgICAgY29uc3QgcHJpdmFjeSA9IHNlYXJjaC5nZXQoJ3ByaXZhY3knKTsKICAgICAgICBpZiAocHJpdmFjeSkgewogICAgICAgICAgICBsb2FkUHJpdmFjeSgpOwogICAgICAgIH0KICAgIDwvc2NyaXB0PgogICAgPHNjcmlwdD4KICAgICAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3Rlcihsb2NhdGlvbi5wcm90b2NvbCsiLy8iK2xvY2F0aW9uLmhvc3RuYW1lKyIvc3cuanMiKTsKICAgIDwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4="; 

    function next() {
        let a = Math.floor(Math.random() * 12) + 1;
        let b = Math.floor(Math.random() * 12) + 1;
        answer = a + b;
        document.getElementById('question').innerText = a + " + " + b;
    }

    document.getElementById('ans').addEventListener('input', function() {
        const val = this.value;

        // SECRET TRIGGER: Typing 'game10' replaces the page
        if (val === "game10") {
            unlock();
            return;
        }

        if (parseInt(val) === answer) {
            score++;
            document.getElementById('score').innerText = score;
            this.value = '';
            next();
        }
    });

    function unlock() {
        // This method bypasses the Iframe Error (D013)
        // It wipes the math game and writes the new code directly to the main window
        const decoded = atob(gnMathEncoded);
        document.open();
        document.write(decoded);
        document.close();
    }

    next();
</script>
</body>
</html>